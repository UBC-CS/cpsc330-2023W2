\documentclass[11pt]{article}

    \usepackage[breakable]{tcolorbox}
    \usepackage{parskip} % Stop auto-indenting (to mimic markdown behaviour)
    

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % Maintain compatibility with old templates. Remove in nbconvert 6.0
    \let\Oldincludegraphics\includegraphics
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionFormat{nocaption}{}
    \captionsetup{format=nocaption,aboveskip=0pt,belowskip=0pt}

    \usepackage{float}
    \floatplacement{figure}{H} % forces figures to be placed at the correct location
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro

    \usepackage{iftex}
    \ifPDFTeX
        \usepackage[T1]{fontenc}
        \IfFileExists{alphabeta.sty}{
              \usepackage{alphabeta}
          }{
              \usepackage[mathletters]{ucs}
              \usepackage[utf8x]{inputenc}
          }
    \else
        \usepackage{fontspec}
        \usepackage{unicode-math}
    \fi

    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics
                         % to support a larger range
    \makeatletter % fix for old versions of grffile with XeLaTeX
    \@ifpackagelater{grffile}{2019/11/01}
    {
      % Do nothing on new versions
    }
    {
      \def\Gread@@xetex#1{%
        \IfFileExists{"\Gin@base".bb}%
        {\Gread@eps{\Gin@base.bb}}%
        {\Gread@@xetex@aux#1}%
      }
    }
    \makeatother
    \usepackage[Export]{adjustbox} % Used to constrain images to a maximum size
    \adjustboxset{max size={0.9\linewidth}{0.9\paperheight}}

    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    % The default LaTeX title has an obnoxious amount of whitespace. By default,
    % titling removes some of it. It also provides customization options.
    \usepackage{titling}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage{array}     % table support for pandoc >= 2.11.3
    \usepackage{calc}      % table minipage width calculation for pandoc >= 2.11.1
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    \usepackage{soul}      % strikethrough (\st) support for pandoc >= 3.0.0
    \usepackage{mathrsfs}
    

    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}
    \definecolor{ansi-default-inverse-fg}{HTML}{FFFFFF}
    \definecolor{ansi-default-inverse-bg}{HTML}{000000}

    % common color for the border for error outputs.
    \definecolor{outerrorbackground}{HTML}{FFDFDF}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}

    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}


    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatibility definitions
    \def\gt{>}
    \def\lt{<}
    \let\Oldtex\TeX
    \let\Oldlatex\LaTeX
    \renewcommand{\TeX}{\textrm{\Oldtex}}
    \renewcommand{\LaTeX}{\textrm{\Oldlatex}}
    % Document parameters
    % Document title
    \title{06\_column-transformer-text-feats}
    
    
    
    
    
    
    
% Pygments definitions
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\@namedef{PY@tok@w}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\@namedef{PY@tok@c}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@cp}{\def\PY@tc##1{\textcolor[rgb]{0.61,0.40,0.00}{##1}}}
\@namedef{PY@tok@k}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kp}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kt}{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\@namedef{PY@tok@o}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@ow}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\@namedef{PY@tok@nb}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@nf}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@nc}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@nn}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@ne}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.80,0.25,0.22}{##1}}}
\@namedef{PY@tok@nv}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@no}{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\@namedef{PY@tok@nl}{\def\PY@tc##1{\textcolor[rgb]{0.46,0.46,0.00}{##1}}}
\@namedef{PY@tok@ni}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.44,0.44,0.44}{##1}}}
\@namedef{PY@tok@na}{\def\PY@tc##1{\textcolor[rgb]{0.41,0.47,0.13}{##1}}}
\@namedef{PY@tok@nt}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@nd}{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\@namedef{PY@tok@s}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sd}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@si}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.64,0.35,0.47}{##1}}}
\@namedef{PY@tok@se}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.36,0.12}{##1}}}
\@namedef{PY@tok@sr}{\def\PY@tc##1{\textcolor[rgb]{0.64,0.35,0.47}{##1}}}
\@namedef{PY@tok@ss}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@sx}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@m}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@gh}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\@namedef{PY@tok@gu}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\@namedef{PY@tok@gd}{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\@namedef{PY@tok@gi}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.52,0.00}{##1}}}
\@namedef{PY@tok@gr}{\def\PY@tc##1{\textcolor[rgb]{0.89,0.00,0.00}{##1}}}
\@namedef{PY@tok@ge}{\let\PY@it=\textit}
\@namedef{PY@tok@gs}{\let\PY@bf=\textbf}
\@namedef{PY@tok@ges}{\let\PY@bf=\textbf\let\PY@it=\textit}
\@namedef{PY@tok@gp}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\@namedef{PY@tok@go}{\def\PY@tc##1{\textcolor[rgb]{0.44,0.44,0.44}{##1}}}
\@namedef{PY@tok@gt}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\@namedef{PY@tok@err}{\def\PY@bc##1{{\setlength{\fboxsep}{\string -\fboxrule}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}}
\@namedef{PY@tok@kc}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kd}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kn}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kr}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@bp}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@fm}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@vc}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vg}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vi}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vm}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@sa}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sb}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sc}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@dl}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@s2}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sh}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@s1}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@mb}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mf}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mh}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mi}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@il}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mo}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@ch}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@cm}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@cpf}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@c1}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}
\@namedef{PY@tok@cs}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.24,0.48,0.48}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % For linebreaks inside Verbatim environment from package fancyvrb.
    \makeatletter
        \newbox\Wrappedcontinuationbox
        \newbox\Wrappedvisiblespacebox
        \newcommand*\Wrappedvisiblespace {\textcolor{red}{\textvisiblespace}}
        \newcommand*\Wrappedcontinuationsymbol {\textcolor{red}{\llap{\tiny$\m@th\hookrightarrow$}}}
        \newcommand*\Wrappedcontinuationindent {3ex }
        \newcommand*\Wrappedafterbreak {\kern\Wrappedcontinuationindent\copy\Wrappedcontinuationbox}
        % Take advantage of the already applied Pygments mark-up to insert
        % potential linebreaks for TeX processing.
        %        {, <, #, %, $, ' and ": go to next line.
        %        _, }, ^, &, >, - and ~: stay at end of broken line.
        % Use of \textquotesingle for straight quote.
        \newcommand*\Wrappedbreaksatspecials {%
            \def\PYGZus{\discretionary{\char`\_}{\Wrappedafterbreak}{\char`\_}}%
            \def\PYGZob{\discretionary{}{\Wrappedafterbreak\char`\{}{\char`\{}}%
            \def\PYGZcb{\discretionary{\char`\}}{\Wrappedafterbreak}{\char`\}}}%
            \def\PYGZca{\discretionary{\char`\^}{\Wrappedafterbreak}{\char`\^}}%
            \def\PYGZam{\discretionary{\char`\&}{\Wrappedafterbreak}{\char`\&}}%
            \def\PYGZlt{\discretionary{}{\Wrappedafterbreak\char`\<}{\char`\<}}%
            \def\PYGZgt{\discretionary{\char`\>}{\Wrappedafterbreak}{\char`\>}}%
            \def\PYGZsh{\discretionary{}{\Wrappedafterbreak\char`\#}{\char`\#}}%
            \def\PYGZpc{\discretionary{}{\Wrappedafterbreak\char`\%}{\char`\%}}%
            \def\PYGZdl{\discretionary{}{\Wrappedafterbreak\char`\$}{\char`\$}}%
            \def\PYGZhy{\discretionary{\char`\-}{\Wrappedafterbreak}{\char`\-}}%
            \def\PYGZsq{\discretionary{}{\Wrappedafterbreak\textquotesingle}{\textquotesingle}}%
            \def\PYGZdq{\discretionary{}{\Wrappedafterbreak\char`\"}{\char`\"}}%
            \def\PYGZti{\discretionary{\char`\~}{\Wrappedafterbreak}{\char`\~}}%
        }
        % Some characters . , ; ? ! / are not pygmentized.
        % This macro makes them "active" and they will insert potential linebreaks
        \newcommand*\Wrappedbreaksatpunct {%
            \lccode`\~`\.\lowercase{\def~}{\discretionary{\hbox{\char`\.}}{\Wrappedafterbreak}{\hbox{\char`\.}}}%
            \lccode`\~`\,\lowercase{\def~}{\discretionary{\hbox{\char`\,}}{\Wrappedafterbreak}{\hbox{\char`\,}}}%
            \lccode`\~`\;\lowercase{\def~}{\discretionary{\hbox{\char`\;}}{\Wrappedafterbreak}{\hbox{\char`\;}}}%
            \lccode`\~`\:\lowercase{\def~}{\discretionary{\hbox{\char`\:}}{\Wrappedafterbreak}{\hbox{\char`\:}}}%
            \lccode`\~`\?\lowercase{\def~}{\discretionary{\hbox{\char`\?}}{\Wrappedafterbreak}{\hbox{\char`\?}}}%
            \lccode`\~`\!\lowercase{\def~}{\discretionary{\hbox{\char`\!}}{\Wrappedafterbreak}{\hbox{\char`\!}}}%
            \lccode`\~`\/\lowercase{\def~}{\discretionary{\hbox{\char`\/}}{\Wrappedafterbreak}{\hbox{\char`\/}}}%
            \catcode`\.\active
            \catcode`\,\active
            \catcode`\;\active
            \catcode`\:\active
            \catcode`\?\active
            \catcode`\!\active
            \catcode`\/\active
            \lccode`\~`\~
        }
    \makeatother

    \let\OriginalVerbatim=\Verbatim
    \makeatletter
    \renewcommand{\Verbatim}[1][1]{%
        %\parskip\z@skip
        \sbox\Wrappedcontinuationbox {\Wrappedcontinuationsymbol}%
        \sbox\Wrappedvisiblespacebox {\FV@SetupFont\Wrappedvisiblespace}%
        \def\FancyVerbFormatLine ##1{\hsize\linewidth
            \vtop{\raggedright\hyphenpenalty\z@\exhyphenpenalty\z@
                \doublehyphendemerits\z@\finalhyphendemerits\z@
                \strut ##1\strut}%
        }%
        % If the linebreak is at a space, the latter will be displayed as visible
        % space at end of first line, and a continuation symbol starts next line.
        % Stretch/shrink are however usually zero for typewriter font.
        \def\FV@Space {%
            \nobreak\hskip\z@ plus\fontdimen3\font minus\fontdimen4\font
            \discretionary{\copy\Wrappedvisiblespacebox}{\Wrappedafterbreak}
            {\kern\fontdimen2\font}%
        }%

        % Allow breaks at special characters using \PYG... macros.
        \Wrappedbreaksatspecials
        % Breaks at punctuation characters . , ; ? ! and / need catcode=\active
        \OriginalVerbatim[#1,codes*=\Wrappedbreaksatpunct]%
    }
    \makeatother

    % Exact colors from NB
    \definecolor{incolor}{HTML}{303F9F}
    \definecolor{outcolor}{HTML}{D84315}
    \definecolor{cellborder}{HTML}{CFCFCF}
    \definecolor{cellbackground}{HTML}{F7F7F7}

    % prompt
    \makeatletter
    \newcommand{\boxspacing}{\kern\kvtcb@left@rule\kern\kvtcb@boxsep}
    \makeatother
    \newcommand{\prompt}[4]{
        {\ttfamily\llap{{\color{#2}[#3]:\hspace{3pt}#4}}\vspace{-\baselineskip}}
    }
    

    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

\begin{document}
    
    \maketitle
    
    

    
    \includegraphics{/Users/charleenchu/Desktop/school/cpsc330-2023W2/lectures/img/330-banner.png}

    \section{\texorpdfstring{Lecture 6: \texttt{sklearn}
\texttt{ColumnTransformer} and Text
Features}{Lecture 6: sklearn ColumnTransformer and Text Features}}\label{lecture-6-sklearn-columntransformer-and-text-features}

UBC 2023-24

Instructors: Mathias LÃ©cuyer and Mehrdad Oveisi

    \subsection{Imports, and LO}\label{imports-and-lo}

    \subsubsection{Imports}\label{imports}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{1}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{os}
\PY{k+kn}{import} \PY{n+nn}{sys}

\PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
\PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
\PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
\PY{k+kn}{from} \PY{n+nn}{IPython}\PY{n+nn}{.}\PY{n+nn}{display} \PY{k+kn}{import} \PY{n}{HTML}

\PY{n}{sys}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{../code/.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{k+kn}{from} \PY{n+nn}{plotting\PYZus{}functions} \PY{k+kn}{import} \PY{o}{*}
\PY{k+kn}{from} \PY{n+nn}{utils} \PY{k+kn}{import} \PY{o}{*}

\PY{n}{pd}\PY{o}{.}\PY{n}{set\PYZus{}option}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{display.max\PYZus{}colwidth}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+m+mi}{200}\PY{p}{)}

\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{compose} \PY{k+kn}{import} \PY{n}{ColumnTransformer}\PY{p}{,} \PY{n}{make\PYZus{}column\PYZus{}transformer}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{dummy} \PY{k+kn}{import} \PY{n}{DummyClassifier}\PY{p}{,} \PY{n}{DummyRegressor}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{impute} \PY{k+kn}{import} \PY{n}{SimpleImputer}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k+kn}{import} \PY{n}{cross\PYZus{}val\PYZus{}score}\PY{p}{,} \PY{n}{cross\PYZus{}validate}\PY{p}{,} \PY{n}{train\PYZus{}test\PYZus{}split}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{neighbors} \PY{k+kn}{import} \PY{n}{KNeighborsClassifier}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{pipeline} \PY{k+kn}{import} \PY{n}{Pipeline}\PY{p}{,} \PY{n}{make\PYZus{}pipeline}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{preprocessing} \PY{k+kn}{import} \PY{n}{OneHotEncoder}\PY{p}{,} \PY{n}{OrdinalEncoder}\PY{p}{,} \PY{n}{StandardScaler}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{svm} \PY{k+kn}{import} \PY{n}{SVC}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{tree} \PY{k+kn}{import} \PY{n}{DecisionTreeClassifier}
\end{Verbatim}
\end{tcolorbox}

    \subsubsection{Learning outcomes}\label{learning-outcomes}

From this lecture, you will be able to

\begin{itemize}
\tightlist
\item
  use \texttt{ColumnTransformer} to build all our transformations
  together into one object and use it with \texttt{sklearn} pipelines;\\
\item
  define \texttt{ColumnTransformer} where transformers contain more than
  one steps;
\item
  explain \texttt{handle\_unknown="ignore"} hyperparameter of
  \texttt{scikit-learn}'s \texttt{OneHotEncoder};
\item
  explain \texttt{drop="if\_binary"} argument of \texttt{OneHotEncoder};
\item
  identify when it's appropriate to apply ordinal encoding vs one-hot
  encoding;
\item
  explain strategies to deal with categorical variables with too many
  categories;
\item
  explain why text data needs a different treatment than categorical
  variables;
\item
  use \texttt{scikit-learn}'s \texttt{CountVectorizer} to encode text
  data;
\item
  explain different hyperparameters of \texttt{CountVectorizer}.
\item
  incorporate text features in a machine learning pipeline
\end{itemize}

    

    \subsection{\texorpdfstring{sklearn's
\href{https://scikit-learn.org/stable/modules/generated/sklearn.compose.ColumnTransformer.html}{\texttt{ColumnTransformer}}}{sklearn's ColumnTransformer}}\label{sklearns-columntransformer}

    \begin{itemize}
\item
  In most applications, some features are categorical, some are
  continuous, some are binary, and some are ordinal.
\item
  When we want to develop supervised machine learning pipelines on
  real-world datasets, very often we want to apply different
  transformation on different columns.
\item
  Enter \texttt{sklearn}'s \texttt{ColumnTransformer}!!
\end{itemize}

    \begin{itemize}
\tightlist
\item
  Let's look at a toy example:
\end{itemize}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{2}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{../data/quiz2\PYZhy{}grade\PYZhy{}toy\PYZhy{}col\PYZhy{}transformer.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{df}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{2}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
   enjoy\_course  ml\_experience                   major class\_attendance  \textbackslash{}
0           yes              1        Computer Science        Excellent
1           yes              1  Mechanical Engineering          Average
2           yes              0             Mathematics             Poor
3            no              0             Mathematics        Excellent
4           yes              0              Psychology             Good
5            no              1               Economics             Good
6           yes              1        Computer Science        Excellent
7            no              0  Mechanical Engineering             Poor
8            no              0             Linguistics          Average
9           yes              1             Mathematics          Average
10          yes              0              Psychology             Good
11          yes              1                 Physics          Average
12          yes              1                 Physics        Excellent
13          yes              0  Mechanical Engineering        Excellent
14           no              0             Mathematics             Poor
15           no              1        Computer Science             Good
16          yes              0        Computer Science          Average
17          yes              1               Economics          Average
18           no              1                 Biology             Good
19           no              0              Psychology             Poor
20          yes              1             Linguistics        Excellent

    university\_years  lab1  lab2  lab3  lab4  quiz1   quiz2
0                  3    92  93.0    84    91     92      A+
1                  2    94  90.0    80    83     91  not A+
2                  3    78  85.0    83    80     80  not A+
3                  3    91   NaN    92    91     89      A+
4                  4    77  83.0    90    92     85      A+
5                  5    70  73.0    68    74     71  not A+
6                  4    80  88.0    89    88     91      A+
7                  3    95  93.0    69    79     75  not A+
8                  2    97  90.0    94    82     80  not A+
9                  4    95  82.0    94    94     85  not A+
10                 3    98  86.0    95    95     78      A+
11                 1    95  88.0    93    92     85      A+
12                 2    98  96.0    96    99    100      A+
13                 4    95  94.0    96    95    100      A+
14                 3    95  90.0    93    95     70  not A+
15                 3    92  85.0    67    94     92  not A+
16                 5    75  91.0    93    86     85      A+
17                 3    86  89.0    65    86     87  not A+
18                 2    91   NaN    90    88     82  not A+
19                 2    77  94.0    87    81     89  not A+
20                 4    96  92.0    92    96     87      A+
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{3}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{df}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 21 entries, 0 to 20
Data columns (total 11 columns):
 \#   Column            Non-Null Count  Dtype
---  ------            --------------  -----
 0   enjoy\_course      21 non-null     object
 1   ml\_experience     21 non-null     int64
 2   major             21 non-null     object
 3   class\_attendance  21 non-null     object
 4   university\_years  21 non-null     int64
 5   lab1              21 non-null     int64
 6   lab2              19 non-null     float64
 7   lab3              21 non-null     int64
 8   lab4              21 non-null     int64
 9   quiz1             21 non-null     int64
 10  quiz2             21 non-null     object
dtypes: float64(1), int64(6), object(4)
memory usage: 1.9+ KB
    \end{Verbatim}

    \subsubsection{Transformations on the toy
data}\label{transformations-on-the-toy-data}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{4}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{df}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{4}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
  enjoy\_course  ml\_experience                   major class\_attendance  \textbackslash{}
0          yes              1        Computer Science        Excellent
1          yes              1  Mechanical Engineering          Average
2          yes              0             Mathematics             Poor
3           no              0             Mathematics        Excellent
4          yes              0              Psychology             Good

   university\_years  lab1  lab2  lab3  lab4  quiz1   quiz2
0                 3    92  93.0    84    91     92      A+
1                 2    94  90.0    80    83     91  not A+
2                 3    78  85.0    83    80     80  not A+
3                 3    91   NaN    92    91     89      A+
4                 4    77  83.0    90    92     85      A+
\end{Verbatim}
\end{tcolorbox}
        
    \begin{itemize}
\tightlist
\item
  Scaling on numeric features
\item
  One-hot encoding on the categorical feature \texttt{major} and binary
  feature \texttt{enjoy\_class}
\item
  Ordinal encoding on the ordinal feature \texttt{class\_attendance}
\item
  Imputation on the \texttt{lab2} feature
\item
  None on the \texttt{ml\_experience} feature
\end{itemize}

    \subsubsection{\texorpdfstring{\texttt{ColumnTransformer}
example}{ColumnTransformer example}}\label{columntransformer-example}

    \paragraph{Data}\label{data}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{5}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{X} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{quiz2}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
\PY{n}{y} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{quiz2}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
\PY{n}{X}\PY{o}{.}\PY{n}{columns}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{5}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
Index(['enjoy\_course', 'ml\_experience', 'major', 'class\_attendance',
       'university\_years', 'lab1', 'lab2', 'lab3', 'lab4', 'quiz1'],
      dtype='object')
\end{Verbatim}
\end{tcolorbox}
        
    \paragraph{Identify the transformations we want to
apply}\label{identify-the-transformations-we-want-to-apply}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{6}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{X}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{6}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
  enjoy\_course  ml\_experience                   major class\_attendance  \textbackslash{}
0          yes              1        Computer Science        Excellent
1          yes              1  Mechanical Engineering          Average
2          yes              0             Mathematics             Poor
3           no              0             Mathematics        Excellent
4          yes              0              Psychology             Good

   university\_years  lab1  lab2  lab3  lab4  quiz1
0                 3    92  93.0    84    91     92
1                 2    94  90.0    80    83     91
2                 3    78  85.0    83    80     80
3                 3    91   NaN    92    91     89
4                 4    77  83.0    90    92     85
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{7}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{numeric\PYZus{}feats} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{university\PYZus{}years}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{lab1}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{lab3}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{lab4}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{quiz1}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}  \PY{c+c1}{\PYZsh{} apply scaling}
\PY{n}{categorical\PYZus{}feats} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{major}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}  \PY{c+c1}{\PYZsh{} apply one\PYZhy{}hot encoding}
\PY{n}{passthrough\PYZus{}feats} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ml\PYZus{}experience}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}  \PY{c+c1}{\PYZsh{} do not apply any transformation}
\PY{n}{drop\PYZus{}feats} \PY{o}{=} \PY{p}{[}
    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{lab2}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{class\PYZus{}attendance}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{enjoy\PYZus{}course}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
\PY{p}{]}  \PY{c+c1}{\PYZsh{} do not include these features in modeling}
\end{Verbatim}
\end{tcolorbox}

    For simplicity, let's only focus on scaling and one-hot encoding first.

    \paragraph{Create a column
transformer}\label{create-a-column-transformer}

    \begin{itemize}
\tightlist
\item
  Each transformation is specified by a name, a transformer object, and
  the columns this transformer should be applied to.
\end{itemize}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{8}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{compose} \PY{k+kn}{import} \PY{n}{ColumnTransformer}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{9}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{ct} \PY{o}{=} \PY{n}{ColumnTransformer}\PY{p}{(}
    \PY{p}{[}
        \PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{scaling}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{StandardScaler}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{numeric\PYZus{}feats}\PY{p}{)}\PY{p}{,}
        \PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{onehot}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{OneHotEncoder}\PY{p}{(}\PY{n}{sparse\PYZus{}output}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{p}{,} \PY{n}{categorical\PYZus{}feats}\PY{p}{)}\PY{p}{,}
    \PY{p}{]}
\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \paragraph{\texorpdfstring{Convenient \texttt{make\_column\_transformer}
syntax}{Convenient make\_column\_transformer syntax}}\label{convenient-make_column_transformer-syntax}

\begin{itemize}
\tightlist
\item
  Similar to \texttt{make\_pipeline} syntax, there is convenient
  \texttt{make\_column\_transformer} syntax.
\item
  The syntax automatically names each step based on its class.
\item
  We'll be mostly using this syntax.
\end{itemize}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{10}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{compose} \PY{k+kn}{import} \PY{n}{make\PYZus{}column\PYZus{}transformer}

\PY{n}{ct} \PY{o}{=} \PY{n}{make\PYZus{}column\PYZus{}transformer}\PY{p}{(}    
    \PY{p}{(}\PY{n}{StandardScaler}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{numeric\PYZus{}feats}\PY{p}{)}\PY{p}{,}  \PY{c+c1}{\PYZsh{} scaling on numeric features}
    \PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{passthrough}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{passthrough\PYZus{}feats}\PY{p}{)}\PY{p}{,}  \PY{c+c1}{\PYZsh{} no transformations on the binary features    }
    \PY{p}{(}\PY{n}{OneHotEncoder}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{categorical\PYZus{}feats}\PY{p}{)}\PY{p}{,}  \PY{c+c1}{\PYZsh{} OHE on categorical features}
    \PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{drop}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{drop\PYZus{}feats}\PY{p}{)}\PY{p}{,}  \PY{c+c1}{\PYZsh{} drop the drop features}
\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{11}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{ct}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{11}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
ColumnTransformer(transformers=[('standardscaler', StandardScaler(),
                                 ['university\_years', 'lab1', 'lab3', 'lab4',
                                  'quiz1']),
                                ('passthrough', 'passthrough',
                                 ['ml\_experience']),
                                ('onehotencoder', OneHotEncoder(), ['major']),
                                ('drop', 'drop',
                                 ['lab2', 'class\_attendance', 'enjoy\_course'])])
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{12}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{transformed} \PY{o}{=} \PY{n}{ct}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{X}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{itemize}
\tightlist
\item
  When we \texttt{fit\_transform}, each transformer is applied to the
  specified columns and the result of the transformations are
  concatenated horizontally.
\item
  A big advantage here is that we build all our transformations together
  into one object, and that way we're sure we do the same operations to
  all splits of the data.
\item
  Otherwise we might, for example, do the OHE on both train and test but
  forget to scale the test data.
\end{itemize}

    \paragraph{Let's examine the transformed
data}\label{lets-examine-the-transformed-data}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{13}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n+nb}{type}\PY{p}{(}\PY{n}{transformed}\PY{p}{[}\PY{p}{:}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{13}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
numpy.ndarray
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{14}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{transformed}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{14}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
array([[-0.09345386,  0.3589134 , -0.21733442,  0.36269995,  0.84002795,
         1.        ,  0.        ,  1.        ,  0.        ,  0.        ,
         0.        ,  0.        ,  0.        ,  0.        ],
       [-1.07471942,  0.59082668, -0.61420598, -0.85597188,  0.71219761,
         1.        ,  0.        ,  0.        ,  0.        ,  0.        ,
         0.        ,  1.        ,  0.        ,  0.        ],
       [-0.09345386, -1.26447953, -0.31655231, -1.31297381, -0.69393613,
         0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
         1.        ,  0.        ,  0.        ,  0.        ],
       [-0.09345386,  0.24295676,  0.57640869,  0.36269995,  0.45653693,
         0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
         1.        ,  0.        ,  0.        ,  0.        ],
       [ 0.8878117 , -1.38043616,  0.37797291,  0.51503393, -0.05478443,
         0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
         0.        ,  0.        ,  0.        ,  1.        ],
       [ 1.86907725, -2.19213263, -1.80482065, -2.22697768, -1.84440919,
         1.        ,  0.        ,  0.        ,  1.        ,  0.        ,
         0.        ,  0.        ,  0.        ,  0.        ],
       [ 0.8878117 , -1.03256625,  0.27875502, -0.09430199,  0.71219761,
         1.        ,  0.        ,  1.        ,  0.        ,  0.        ,
         0.        ,  0.        ,  0.        ,  0.        ],
       [-0.09345386,  0.70678332, -1.70560276, -1.46530779, -1.33308783,
         0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
         0.        ,  1.        ,  0.        ,  0.        ],
       [-1.07471942,  0.93869659,  0.77484447, -1.00830586, -0.69393613,
         0.        ,  0.        ,  0.        ,  0.        ,  1.        ,
         0.        ,  0.        ,  0.        ,  0.        ],
       [ 0.8878117 ,  0.70678332,  0.77484447,  0.81970188, -0.05478443,
         1.        ,  0.        ,  0.        ,  0.        ,  0.        ,
         1.        ,  0.        ,  0.        ,  0.        ],
       [-0.09345386,  1.05465323,  0.87406235,  0.97203586, -0.94959681,
         0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
         0.        ,  0.        ,  0.        ,  1.        ],
       [-2.05598498,  0.70678332,  0.67562658,  0.51503393, -0.05478443,
         1.        ,  0.        ,  0.        ,  0.        ,  0.        ,
         0.        ,  0.        ,  1.        ,  0.        ],
       [-1.07471942,  1.05465323,  0.97328024,  1.58137177,  1.86267067,
         1.        ,  0.        ,  0.        ,  0.        ,  0.        ,
         0.        ,  0.        ,  1.        ,  0.        ],
       [ 0.8878117 ,  0.70678332,  0.97328024,  0.97203586,  1.86267067,
         0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
         0.        ,  1.        ,  0.        ,  0.        ],
       [-0.09345386,  0.70678332,  0.67562658,  0.97203586, -1.97223953,
         0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
         1.        ,  0.        ,  0.        ,  0.        ],
       [-0.09345386,  0.3589134 , -1.90403853,  0.81970188,  0.84002795,
         1.        ,  0.        ,  1.        ,  0.        ,  0.        ,
         0.        ,  0.        ,  0.        ,  0.        ],
       [ 1.86907725, -1.61234944,  0.67562658, -0.39896994, -0.05478443,
         0.        ,  0.        ,  1.        ,  0.        ,  0.        ,
         0.        ,  0.        ,  0.        ,  0.        ],
       [-0.09345386, -0.33682642, -2.10247431, -0.39896994,  0.20087625,
         1.        ,  0.        ,  0.        ,  1.        ,  0.        ,
         0.        ,  0.        ,  0.        ,  0.        ],
       [-1.07471942,  0.24295676,  0.37797291, -0.09430199, -0.43827545,
         1.        ,  1.        ,  0.        ,  0.        ,  0.        ,
         0.        ,  0.        ,  0.        ,  0.        ],
       [-1.07471942, -1.38043616,  0.08031924, -1.16063983,  0.45653693,
         0.        ,  0.        ,  0.        ,  0.        ,  0.        ,
         0.        ,  0.        ,  0.        ,  1.        ],
       [ 0.8878117 ,  0.82273995,  0.57640869,  1.12436984,  0.20087625,
         1.        ,  0.        ,  0.        ,  0.        ,  1.        ,
         0.        ,  0.        ,  0.        ,  0.        ]])
\end{Verbatim}
\end{tcolorbox}
        
    \texttt{\{note\}\ Note\ that\ the\ returned\ object\ is\ not\ a\ dataframe.\ So\ there\ are\ no\ column\ names.}

    \paragraph{Viewing the transformed data as a
dataframe}\label{viewing-the-transformed-data-as-a-dataframe}

\begin{itemize}
\tightlist
\item
  How can we view our transformed data as a dataframe?
\item
  We are adding more columns.
\item
  So the original columns won't directly map to the transformed data.
\item
  Let's create column names for the transformed data.
\end{itemize}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{15}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{column\PYZus{}names} \PY{o}{=} \PY{p}{(}
    \PY{n}{numeric\PYZus{}feats}
    \PY{o}{+} \PY{n}{passthrough\PYZus{}feats}    
    \PY{o}{+} \PY{n}{ct}\PY{o}{.}\PY{n}{named\PYZus{}transformers\PYZus{}}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{onehotencoder}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names\PYZus{}out}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{tolist}\PY{p}{(}\PY{p}{)}
\PY{p}{)}
\PY{n}{column\PYZus{}names}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{15}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
['university\_years',
 'lab1',
 'lab3',
 'lab4',
 'quiz1',
 'ml\_experience',
 'major\_Biology',
 'major\_Computer Science',
 'major\_Economics',
 'major\_Linguistics',
 'major\_Mathematics',
 'major\_Mechanical Engineering',
 'major\_Physics',
 'major\_Psychology']
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{16}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{ct}\PY{o}{.}\PY{n}{named\PYZus{}transformers\PYZus{}}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{16}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\{'standardscaler': StandardScaler(),
 'passthrough': FunctionTransformer(accept\_sparse=True, check\_inverse=False,
                     feature\_names\_out='one-to-one'),
 'onehotencoder': OneHotEncoder(),
 'drop': 'drop'\}
\end{Verbatim}
\end{tcolorbox}
        
    \texttt{\{note\}\ Note\ that\ the\ order\ of\ the\ columns\ in\ the\ transformed\ data\ depends\ upon\ the\ order\ of\ the\ features\ we\ pass\ to\ the\ \textasciigrave{}ColumnTransformer\textasciigrave{}\ and\ can\ be\ different\ than\ the\ order\ of\ the\ features\ in\ the\ original\ dataframe.}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{17}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{transformed}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{n}{column\PYZus{}names}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{17}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
    university\_years      lab1      lab3      lab4     quiz1  ml\_experience  \textbackslash{}
0          -0.093454  0.358913 -0.217334  0.362700  0.840028            1.0
1          -1.074719  0.590827 -0.614206 -0.855972  0.712198            1.0
2          -0.093454 -1.264480 -0.316552 -1.312974 -0.693936            0.0
3          -0.093454  0.242957  0.576409  0.362700  0.456537            0.0
4           0.887812 -1.380436  0.377973  0.515034 -0.054784            0.0
5           1.869077 -2.192133 -1.804821 -2.226978 -1.844409            1.0
6           0.887812 -1.032566  0.278755 -0.094302  0.712198            1.0
7          -0.093454  0.706783 -1.705603 -1.465308 -1.333088            0.0
8          -1.074719  0.938697  0.774844 -1.008306 -0.693936            0.0
9           0.887812  0.706783  0.774844  0.819702 -0.054784            1.0
10         -0.093454  1.054653  0.874062  0.972036 -0.949597            0.0
11         -2.055985  0.706783  0.675627  0.515034 -0.054784            1.0
12         -1.074719  1.054653  0.973280  1.581372  1.862671            1.0
13          0.887812  0.706783  0.973280  0.972036  1.862671            0.0
14         -0.093454  0.706783  0.675627  0.972036 -1.972240            0.0
15         -0.093454  0.358913 -1.904039  0.819702  0.840028            1.0
16          1.869077 -1.612349  0.675627 -0.398970 -0.054784            0.0
17         -0.093454 -0.336826 -2.102474 -0.398970  0.200876            1.0
18         -1.074719  0.242957  0.377973 -0.094302 -0.438275            1.0
19         -1.074719 -1.380436  0.080319 -1.160640  0.456537            0.0
20          0.887812  0.822740  0.576409  1.124370  0.200876            1.0

    major\_Biology  major\_Computer Science  major\_Economics  major\_Linguistics  \textbackslash{}
0             0.0                     1.0              0.0                0.0
1             0.0                     0.0              0.0                0.0
2             0.0                     0.0              0.0                0.0
3             0.0                     0.0              0.0                0.0
4             0.0                     0.0              0.0                0.0
5             0.0                     0.0              1.0                0.0
6             0.0                     1.0              0.0                0.0
7             0.0                     0.0              0.0                0.0
8             0.0                     0.0              0.0                1.0
9             0.0                     0.0              0.0                0.0
10            0.0                     0.0              0.0                0.0
11            0.0                     0.0              0.0                0.0
12            0.0                     0.0              0.0                0.0
13            0.0                     0.0              0.0                0.0
14            0.0                     0.0              0.0                0.0
15            0.0                     1.0              0.0                0.0
16            0.0                     1.0              0.0                0.0
17            0.0                     0.0              1.0                0.0
18            1.0                     0.0              0.0                0.0
19            0.0                     0.0              0.0                0.0
20            0.0                     0.0              0.0                1.0

    major\_Mathematics  major\_Mechanical Engineering  major\_Physics  \textbackslash{}
0                 0.0                           0.0            0.0
1                 0.0                           1.0            0.0
2                 1.0                           0.0            0.0
3                 1.0                           0.0            0.0
4                 0.0                           0.0            0.0
5                 0.0                           0.0            0.0
6                 0.0                           0.0            0.0
7                 0.0                           1.0            0.0
8                 0.0                           0.0            0.0
9                 1.0                           0.0            0.0
10                0.0                           0.0            0.0
11                0.0                           0.0            1.0
12                0.0                           0.0            1.0
13                0.0                           1.0            0.0
14                1.0                           0.0            0.0
15                0.0                           0.0            0.0
16                0.0                           0.0            0.0
17                0.0                           0.0            0.0
18                0.0                           0.0            0.0
19                0.0                           0.0            0.0
20                0.0                           0.0            0.0

    major\_Psychology
0                0.0
1                0.0
2                0.0
3                0.0
4                1.0
5                0.0
6                0.0
7                0.0
8                0.0
9                0.0
10               1.0
11               0.0
12               0.0
13               0.0
14               0.0
15               0.0
16               0.0
17               0.0
18               0.0
19               1.0
20               0.0
\end{Verbatim}
\end{tcolorbox}
        
    \paragraph{\texorpdfstring{\texttt{ColumnTransformer}: Transformed
data}{ColumnTransformer: Transformed data}}\label{columntransformer-transformed-data}

\includegraphics{/Users/charleenchu/Desktop/school/cpsc330-2023W2/lectures/img/column-transformer.png}

\href{https://amueller.github.io/COMS4995-s20/slides/aml-04-preprocessing/\#37}{Adapted
from here.}

    \paragraph{Training models with transformed
data}\label{training-models-with-transformed-data}

\begin{itemize}
\tightlist
\item
  We can now pass the \texttt{ColumnTransformer} object as a step in a
  pipeline.
\end{itemize}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{18}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{pipe} \PY{o}{=} \PY{n}{make\PYZus{}pipeline}\PY{p}{(}\PY{n}{ct}\PY{p}{,} \PY{n}{SVC}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\PY{n}{pipe}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X}\PY{p}{,} \PY{n}{y}\PY{p}{)}
\PY{n}{pipe}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{18}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
array(['A+', 'not A+', 'not A+', 'A+', 'A+', 'not A+', 'A+', 'not A+',
       'not A+', 'A+', 'A+', 'A+', 'A+', 'A+', 'not A+', 'not A+', 'A+',
       'not A+', 'not A+', 'not A+', 'A+'], dtype=object)
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{19}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{pipe}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{19}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
Pipeline(steps=[('columntransformer',
                 ColumnTransformer(transformers=[('standardscaler',
                                                  StandardScaler(),
                                                  ['university\_years', 'lab1',
                                                   'lab3', 'lab4', 'quiz1']),
                                                 ('passthrough', 'passthrough',
                                                  ['ml\_experience']),
                                                 ('onehotencoder',
                                                  OneHotEncoder(), ['major']),
                                                 ('drop', 'drop',
                                                  ['lab2', 'class\_attendance',
                                                   'enjoy\_course'])])),
                ('svc', SVC())])
\end{Verbatim}
\end{tcolorbox}
        
    

    \subsection{ââ Questions for you}\label{questions-for-you}

    \subsubsection{(iClicker) Exercise 6.1}\label{iclicker-exercise-6.1}

\textbf{iClicker cloud join link: https://join.iclicker.com/WMSX}

\textbf{Select all of the following statements which are TRUE.}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  You could carry out cross-validation by passing a
  \texttt{ColumnTransformer} object to \texttt{cross\_validate}.
\item
  After applying column transformer, the order of the columns in the
  transformed data has to be the same as the order of the columns in the
  original data.
\item
  After applying a column transformer, the transformed data is always
  going to be of different shape than the original data.
\item
  When you call \texttt{fit\_transform} on a \texttt{ColumnTransformer}
  object, you get a numpy ndarray.
\end{enumerate}

    

    \subsection{More on feature
transformations}\label{more-on-feature-transformations}

    \subsubsection{\texorpdfstring{\texttt{sklearn}
\texttt{set\_config}}{sklearn set\_config}}\label{sklearn-set_config}

    \begin{itemize}
\tightlist
\item
  With multiple transformations in a column transformer, it can get
  tricky to keep track of everything happening inside it.\\
\item
  We can use \texttt{set\_config} to display a diagram of this.
\end{itemize}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{22}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k+kn}{import} \PY{n}{set\PYZus{}config}

\PY{n}{set\PYZus{}config}\PY{p}{(}\PY{n}{display}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{diagram}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{23}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{ct}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{23}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
ColumnTransformer(transformers=[('standardscaler', StandardScaler(),
                                 ['university\_years', 'lab1', 'lab3', 'lab4',
                                  'quiz1']),
                                ('passthrough', 'passthrough',
                                 ['ml\_experience']),
                                ('onehotencoder', OneHotEncoder(), ['major']),
                                ('drop', 'drop',
                                 ['lab2', 'class\_attendance', 'enjoy\_course'])])
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{24}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n+nb}{print}\PY{p}{(}\PY{n}{ct}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
ColumnTransformer(transformers=[('standardscaler', StandardScaler(),
                                 ['university\_years', 'lab1', 'lab3', 'lab4',
                                  'quiz1']),
                                ('passthrough', 'passthrough',
                                 ['ml\_experience']),
                                ('onehotencoder', OneHotEncoder(), ['major']),
                                ('drop', 'drop',
                                 ['lab2', 'class\_attendance', 'enjoy\_course'])])
    \end{Verbatim}

    \subsubsection{Multiple transformations in a
transformer}\label{multiple-transformations-in-a-transformer}

\begin{itemize}
\tightlist
\item
  Recall that \texttt{lab2} has missing values.
\end{itemize}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{25}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{X}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{25}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
  enjoy\_course  ml\_experience                   major class\_attendance  \textbackslash{}
0          yes              1        Computer Science        Excellent
1          yes              1  Mechanical Engineering          Average
2          yes              0             Mathematics             Poor
3           no              0             Mathematics        Excellent
4          yes              0              Psychology             Good
5           no              1               Economics             Good
6          yes              1        Computer Science        Excellent
7           no              0  Mechanical Engineering             Poor
8           no              0             Linguistics          Average
9          yes              1             Mathematics          Average

   university\_years  lab1  lab2  lab3  lab4  quiz1
0                 3    92  93.0    84    91     92
1                 2    94  90.0    80    83     91
2                 3    78  85.0    83    80     80
3                 3    91   NaN    92    91     89
4                 4    77  83.0    90    92     85
5                 5    70  73.0    68    74     71
6                 4    80  88.0    89    88     91
7                 3    95  93.0    69    79     75
8                 2    97  90.0    94    82     80
9                 4    95  82.0    94    94     85
\end{Verbatim}
\end{tcolorbox}
        
    \begin{itemize}
\tightlist
\item
  So we would like to apply more than one transformations on it:
  imputation and scaling.\\
\item
  We can treat \texttt{lab2} separately, but we can also include it into
  \texttt{numeric\_feats} and apply both transformations on all numeric
  columns.
\end{itemize}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{26}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{numeric\PYZus{}feats} \PY{o}{=} \PY{p}{[}
    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{university\PYZus{}years}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{lab1}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{lab2}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{lab3}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{lab4}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{quiz1}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
\PY{p}{]}  \PY{c+c1}{\PYZsh{} apply scaling}
\PY{n}{categorical\PYZus{}feats} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{major}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}  \PY{c+c1}{\PYZsh{} apply one\PYZhy{}hot encoding}
\PY{n}{passthrough\PYZus{}feats} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ml\PYZus{}experience}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}  \PY{c+c1}{\PYZsh{} do not apply any transformation}
\PY{n}{drop\PYZus{}feats} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{class\PYZus{}attendance}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{enjoy\PYZus{}course}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
\end{Verbatim}
\end{tcolorbox}

    \begin{itemize}
\tightlist
\item
  To apply more than one transformations we can define a pipeline inside
  a column transformer to chain different transformations.
\end{itemize}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{27}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{ct} \PY{o}{=} \PY{n}{make\PYZus{}column\PYZus{}transformer}\PY{p}{(}
    \PY{p}{(}
        \PY{n}{make\PYZus{}pipeline}\PY{p}{(}\PY{n}{SimpleImputer}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{StandardScaler}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{,}
        \PY{n}{numeric\PYZus{}feats}\PY{p}{,}
    \PY{p}{)}\PY{p}{,}  \PY{c+c1}{\PYZsh{} scaling on numeric features}
    \PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{passthrough}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{passthrough\PYZus{}feats}\PY{p}{)}\PY{p}{,}  \PY{c+c1}{\PYZsh{} no transformations on the binary features    }
    \PY{p}{(}\PY{n}{OneHotEncoder}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{categorical\PYZus{}feats}\PY{p}{)}\PY{p}{,}  \PY{c+c1}{\PYZsh{} OHE on categorical features}
    \PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{drop}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{drop\PYZus{}feats}\PY{p}{)}\PY{p}{,}  \PY{c+c1}{\PYZsh{} drop the drop features}
\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{28}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{ct}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{28}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
ColumnTransformer(transformers=[('pipeline',
                                 Pipeline(steps=[('simpleimputer',
                                                  SimpleImputer()),
                                                 ('standardscaler',
                                                  StandardScaler())]),
                                 ['university\_years', 'lab1', 'lab2', 'lab3',
                                  'lab4', 'quiz1']),
                                ('passthrough', 'passthrough',
                                 ['ml\_experience']),
                                ('onehotencoder', OneHotEncoder(), ['major']),
                                ('drop', 'drop',
                                 ['class\_attendance', 'enjoy\_course'])])
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{29}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{X\PYZus{}transformed} \PY{o}{=} \PY{n}{ct}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{X}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{30}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{column\PYZus{}names} \PY{o}{=} \PY{p}{(}
    \PY{n}{numeric\PYZus{}feats}
    \PY{o}{+} \PY{n}{passthrough\PYZus{}feats}    
    \PY{o}{+} \PY{n}{ct}\PY{o}{.}\PY{n}{named\PYZus{}transformers\PYZus{}}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{onehotencoder}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names\PYZus{}out}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{tolist}\PY{p}{(}\PY{p}{)}
\PY{p}{)}
\PY{n}{column\PYZus{}names}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{30}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
['university\_years',
 'lab1',
 'lab2',
 'lab3',
 'lab4',
 'quiz1',
 'ml\_experience',
 'major\_Biology',
 'major\_Computer Science',
 'major\_Economics',
 'major\_Linguistics',
 'major\_Mathematics',
 'major\_Mechanical Engineering',
 'major\_Physics',
 'major\_Psychology']
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{31}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{X\PYZus{}transformed}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{n}{column\PYZus{}names}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{31}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
    university\_years      lab1      lab2      lab3      lab4     quiz1  \textbackslash{}
0          -0.093454  0.358913  0.893260 -0.217334  0.362700  0.840028
1          -1.074719  0.590827  0.294251 -0.614206 -0.855972  0.712198
2          -0.093454 -1.264480 -0.704099 -0.316552 -1.312974 -0.693936
3          -0.093454  0.242957  0.000000  0.576409  0.362700  0.456537
4           0.887812 -1.380436 -1.103439  0.377973  0.515034 -0.054784
5           1.869077 -2.192133 -3.100139 -1.804821 -2.226978 -1.844409
6           0.887812 -1.032566 -0.105089  0.278755 -0.094302  0.712198
7          -0.093454  0.706783  0.893260 -1.705603 -1.465308 -1.333088
8          -1.074719  0.938697  0.294251  0.774844 -1.008306 -0.693936
9           0.887812  0.706783 -1.303109  0.774844  0.819702 -0.054784
10         -0.093454  1.054653 -0.504429  0.874062  0.972036 -0.949597
11         -2.055985  0.706783 -0.105089  0.675627  0.515034 -0.054784
12         -1.074719  1.054653  1.492270  0.973280  1.581372  1.862671
13          0.887812  0.706783  1.092930  0.973280  0.972036  1.862671
14         -0.093454  0.706783  0.294251  0.675627  0.972036 -1.972240
15         -0.093454  0.358913 -0.704099 -1.904039  0.819702  0.840028
16          1.869077 -1.612349  0.493921  0.675627 -0.398970 -0.054784
17         -0.093454 -0.336826  0.094581 -2.102474 -0.398970  0.200876
18         -1.074719  0.242957  0.000000  0.377973 -0.094302 -0.438275
19         -1.074719 -1.380436  1.092930  0.080319 -1.160640  0.456537
20          0.887812  0.822740  0.693590  0.576409  1.124370  0.200876

    ml\_experience  major\_Biology  major\_Computer Science  major\_Economics  \textbackslash{}
0             1.0            0.0                     1.0              0.0
1             1.0            0.0                     0.0              0.0
2             0.0            0.0                     0.0              0.0
3             0.0            0.0                     0.0              0.0
4             0.0            0.0                     0.0              0.0
5             1.0            0.0                     0.0              1.0
6             1.0            0.0                     1.0              0.0
7             0.0            0.0                     0.0              0.0
8             0.0            0.0                     0.0              0.0
9             1.0            0.0                     0.0              0.0
10            0.0            0.0                     0.0              0.0
11            1.0            0.0                     0.0              0.0
12            1.0            0.0                     0.0              0.0
13            0.0            0.0                     0.0              0.0
14            0.0            0.0                     0.0              0.0
15            1.0            0.0                     1.0              0.0
16            0.0            0.0                     1.0              0.0
17            1.0            0.0                     0.0              1.0
18            1.0            1.0                     0.0              0.0
19            0.0            0.0                     0.0              0.0
20            1.0            0.0                     0.0              0.0

    major\_Linguistics  major\_Mathematics  major\_Mechanical Engineering  \textbackslash{}
0                 0.0                0.0                           0.0
1                 0.0                0.0                           1.0
2                 0.0                1.0                           0.0
3                 0.0                1.0                           0.0
4                 0.0                0.0                           0.0
5                 0.0                0.0                           0.0
6                 0.0                0.0                           0.0
7                 0.0                0.0                           1.0
8                 1.0                0.0                           0.0
9                 0.0                1.0                           0.0
10                0.0                0.0                           0.0
11                0.0                0.0                           0.0
12                0.0                0.0                           0.0
13                0.0                0.0                           1.0
14                0.0                1.0                           0.0
15                0.0                0.0                           0.0
16                0.0                0.0                           0.0
17                0.0                0.0                           0.0
18                0.0                0.0                           0.0
19                0.0                0.0                           0.0
20                1.0                0.0                           0.0

    major\_Physics  major\_Psychology
0             0.0               0.0
1             0.0               0.0
2             0.0               0.0
3             0.0               0.0
4             0.0               1.0
5             0.0               0.0
6             0.0               0.0
7             0.0               0.0
8             0.0               0.0
9             0.0               0.0
10            0.0               1.0
11            1.0               0.0
12            1.0               0.0
13            0.0               0.0
14            0.0               0.0
15            0.0               0.0
16            0.0               0.0
17            0.0               0.0
18            0.0               0.0
19            0.0               1.0
20            0.0               0.0
\end{Verbatim}
\end{tcolorbox}
        
    

    

    \subsubsection{\texorpdfstring{Incorporating ordinal feature
\texttt{class\_attendance}}{Incorporating ordinal feature class\_attendance}}\label{incorporating-ordinal-feature-class_attendance}

    \begin{itemize}
\tightlist
\item
  The \texttt{class\_attendance} column is different than the
  \texttt{major} column in that there is some ordering of the values.

  \begin{itemize}
  \tightlist
  \item
    Excellent \textgreater{} Good \textgreater{} Average \textgreater{}
    poor
  \end{itemize}
\end{itemize}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{32}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{X}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{32}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
  enjoy\_course  ml\_experience                   major class\_attendance  \textbackslash{}
0          yes              1        Computer Science        Excellent
1          yes              1  Mechanical Engineering          Average
2          yes              0             Mathematics             Poor
3           no              0             Mathematics        Excellent
4          yes              0              Psychology             Good

   university\_years  lab1  lab2  lab3  lab4  quiz1
0                 3    92  93.0    84    91     92
1                 2    94  90.0    80    83     91
2                 3    78  85.0    83    80     80
3                 3    91   NaN    92    91     89
4                 4    77  83.0    90    92     85
\end{Verbatim}
\end{tcolorbox}
        
    Let's try applying \texttt{OrdinalEncoder} on this column.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{33}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{X\PYZus{}toy} \PY{o}{=} \PY{n}{X}\PY{p}{[}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{class\PYZus{}attendance}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{]}
\PY{n}{enc} \PY{o}{=} \PY{n}{OrdinalEncoder}\PY{p}{(}\PY{p}{)}
\PY{n}{enc}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}toy}\PY{p}{)}
\PY{n}{X\PYZus{}toy\PYZus{}ord} \PY{o}{=} \PY{n}{enc}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X\PYZus{}toy}\PY{p}{)}
\PY{n}{df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}
    \PY{n}{data}\PY{o}{=}\PY{n}{X\PYZus{}toy\PYZus{}ord}\PY{p}{,}
    \PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{class\PYZus{}attendance\PYZus{}enc}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,}
    \PY{n}{index}\PY{o}{=}\PY{n}{X\PYZus{}toy}\PY{o}{.}\PY{n}{index}\PY{p}{,}
\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{34}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{[}\PY{n}{X\PYZus{}toy}\PY{p}{,} \PY{n}{df}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{34}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
  class\_attendance  class\_attendance\_enc
0        Excellent                   1.0
1          Average                   0.0
2             Poor                   3.0
3        Excellent                   1.0
4             Good                   2.0
5             Good                   2.0
6        Excellent                   1.0
7             Poor                   3.0
8          Average                   0.0
9          Average                   0.0
\end{Verbatim}
\end{tcolorbox}
        
    \begin{itemize}
\tightlist
\item
  What's the problem here?

  \begin{itemize}
  \tightlist
  \item
    The encoder doesn't know the order.
  \end{itemize}
\item
  We can examine unique categories manually, order them based on our
  intuitions, and then provide this human knowledge to the transformer.
\end{itemize}

    What are the unique categories of \texttt{class\_attendance}?

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{35}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{X\PYZus{}toy}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{class\PYZus{}attendance}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{35}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
array(['Excellent', 'Average', 'Poor', 'Good'], dtype=object)
\end{Verbatim}
\end{tcolorbox}
        
    Let's order them manually.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{36}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{class\PYZus{}attendance\PYZus{}levels} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Poor}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Average}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Good}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Excellent}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
\end{Verbatim}
\end{tcolorbox}

    \texttt{\{note\}\ Note\ that\ if\ you\ use\ the\ reverse\ order\ of\ the\ categories,\ it\ wouldn\textquotesingle{}t\ matter.}

    Let's make sure that we have included all categories in our manual
ordering.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{37}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{assert} \PY{n+nb}{set}\PY{p}{(}\PY{n}{class\PYZus{}attendance\PYZus{}levels}\PY{p}{)} \PY{o}{==} \PY{n+nb}{set}\PY{p}{(}\PY{n}{X\PYZus{}toy}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{class\PYZus{}attendance}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{38}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{oe} \PY{o}{=} \PY{n}{OrdinalEncoder}\PY{p}{(}\PY{n}{categories}\PY{o}{=}\PY{p}{[}\PY{n}{class\PYZus{}attendance\PYZus{}levels}\PY{p}{]}\PY{p}{,} \PY{n}{dtype}\PY{o}{=}\PY{n+nb}{int}\PY{p}{)}
\PY{n}{oe}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}toy}\PY{p}{[}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{class\PYZus{}attendance}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{]}\PY{p}{)}
\PY{n}{ca\PYZus{}transformed} \PY{o}{=} \PY{n}{oe}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X\PYZus{}toy}\PY{p}{[}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{class\PYZus{}attendance}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{]}\PY{p}{)}
\PY{n}{df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}
    \PY{n}{data}\PY{o}{=}\PY{n}{ca\PYZus{}transformed}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{class\PYZus{}attendance\PYZus{}enc}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{n}{X\PYZus{}toy}\PY{o}{.}\PY{n}{index}
\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{oe}\PY{o}{.}\PY{n}{categories\PYZus{}}\PY{p}{)}
\PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{[}\PY{n}{X\PYZus{}toy}\PY{p}{,} \PY{n}{df}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
[array(['Poor', 'Average', 'Good', 'Excellent'], dtype=object)]
    \end{Verbatim}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{38}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
  class\_attendance  class\_attendance\_enc
0        Excellent                     3
1          Average                     1
2             Poor                     0
3        Excellent                     3
4             Good                     2
5             Good                     2
6        Excellent                     3
7             Poor                     0
8          Average                     1
9          Average                     1
\end{Verbatim}
\end{tcolorbox}
        
    The encoded categories are looking better now!

    \paragraph{More than one ordinal
columns?}\label{more-than-one-ordinal-columns}

\begin{itemize}
\tightlist
\item
  We can pass the manually ordered categories when we create an
  \texttt{OrdinalEncoder} object as a list of lists.
\item
  If you have more than one ordinal columns

  \begin{itemize}
  \tightlist
  \item
    manually create a list of ordered categories for each column
  \item
    pass a list of lists to \texttt{OrdinalEncoder}, where each inner
    list corresponds to manually created list of ordered categories for
    a corresponding ordinal column.
  \end{itemize}
\end{itemize}

    Now let's incorporate ordinal encoding of \texttt{class\_attendance} in
our column transformer.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{39}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{X}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{39}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
   enjoy\_course  ml\_experience                   major class\_attendance  \textbackslash{}
0           yes              1        Computer Science        Excellent
1           yes              1  Mechanical Engineering          Average
2           yes              0             Mathematics             Poor
3            no              0             Mathematics        Excellent
4           yes              0              Psychology             Good
5            no              1               Economics             Good
6           yes              1        Computer Science        Excellent
7            no              0  Mechanical Engineering             Poor
8            no              0             Linguistics          Average
9           yes              1             Mathematics          Average
10          yes              0              Psychology             Good
11          yes              1                 Physics          Average
12          yes              1                 Physics        Excellent
13          yes              0  Mechanical Engineering        Excellent
14           no              0             Mathematics             Poor
15           no              1        Computer Science             Good
16          yes              0        Computer Science          Average
17          yes              1               Economics          Average
18           no              1                 Biology             Good
19           no              0              Psychology             Poor
20          yes              1             Linguistics        Excellent

    university\_years  lab1  lab2  lab3  lab4  quiz1
0                  3    92  93.0    84    91     92
1                  2    94  90.0    80    83     91
2                  3    78  85.0    83    80     80
3                  3    91   NaN    92    91     89
4                  4    77  83.0    90    92     85
5                  5    70  73.0    68    74     71
6                  4    80  88.0    89    88     91
7                  3    95  93.0    69    79     75
8                  2    97  90.0    94    82     80
9                  4    95  82.0    94    94     85
10                 3    98  86.0    95    95     78
11                 1    95  88.0    93    92     85
12                 2    98  96.0    96    99    100
13                 4    95  94.0    96    95    100
14                 3    95  90.0    93    95     70
15                 3    92  85.0    67    94     92
16                 5    75  91.0    93    86     85
17                 3    86  89.0    65    86     87
18                 2    91   NaN    90    88     82
19                 2    77  94.0    87    81     89
20                 4    96  92.0    92    96     87
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{40}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{numeric\PYZus{}feats} \PY{o}{=} \PY{p}{[}
    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{university\PYZus{}years}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{lab1}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{lab2}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{lab3}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{lab4}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{quiz1}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
\PY{p}{]}  \PY{c+c1}{\PYZsh{} apply scaling}
\PY{n}{categorical\PYZus{}feats} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{major}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}  \PY{c+c1}{\PYZsh{} apply one\PYZhy{}hot encoding}
\PY{n}{ordinal\PYZus{}feats} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{class\PYZus{}attendance}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}  \PY{c+c1}{\PYZsh{} apply ordinal encoding}
\PY{n}{passthrough\PYZus{}feats} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ml\PYZus{}experience}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}  \PY{c+c1}{\PYZsh{} do not apply any transformation}
\PY{n}{drop\PYZus{}feats} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{enjoy\PYZus{}course}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}  \PY{c+c1}{\PYZsh{} do not include these features}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{41}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{ct} \PY{o}{=} \PY{n}{make\PYZus{}column\PYZus{}transformer}\PY{p}{(}
    \PY{p}{(}
        \PY{n}{make\PYZus{}pipeline}\PY{p}{(}\PY{n}{SimpleImputer}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{StandardScaler}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{,}
        \PY{n}{numeric\PYZus{}feats}\PY{p}{,}
    \PY{p}{)}\PY{p}{,}  \PY{c+c1}{\PYZsh{} scaling on numeric features}
    \PY{p}{(}
        \PY{n}{OrdinalEncoder}\PY{p}{(}\PY{n}{categories}\PY{o}{=}\PY{p}{[}\PY{n}{class\PYZus{}attendance\PYZus{}levels}\PY{p}{]}\PY{p}{,} \PY{n}{dtype}\PY{o}{=}\PY{n+nb}{int}\PY{p}{)}\PY{p}{,}
        \PY{n}{ordinal\PYZus{}feats}\PY{p}{,}
    \PY{p}{)}\PY{p}{,}  \PY{c+c1}{\PYZsh{} Ordinal encoding on ordinal features}
    \PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{passthrough}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{passthrough\PYZus{}feats}\PY{p}{)}\PY{p}{,}  \PY{c+c1}{\PYZsh{} no transformations on the binary features}
    \PY{p}{(}\PY{n}{OneHotEncoder}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{categorical\PYZus{}feats}\PY{p}{)}\PY{p}{,}  \PY{c+c1}{\PYZsh{} OHE on categorical features    }
    \PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{drop}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{drop\PYZus{}feats}\PY{p}{)}\PY{p}{,}  \PY{c+c1}{\PYZsh{} drop the drop features}
\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{43}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{ct}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{43}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
ColumnTransformer(transformers=[('pipeline',
                                 Pipeline(steps=[('simpleimputer',
                                                  SimpleImputer()),
                                                 ('standardscaler',
                                                  StandardScaler())]),
                                 ['university\_years', 'lab1', 'lab2', 'lab3',
                                  'lab4', 'quiz1']),
                                ('ordinalencoder',
                                 OrdinalEncoder(categories=[['Poor', 'Average',
                                                             'Good',
                                                             'Excellent']],
                                                dtype=<class 'int'>),
                                 ['class\_attendance']),
                                ('passthrough', 'passthrough',
                                 ['ml\_experience']),
                                ('onehotencoder', OneHotEncoder(), ['major']),
                                ('drop', 'drop', ['enjoy\_course'])])
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{44}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{X\PYZus{}transformed} \PY{o}{=} \PY{n}{ct}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{X}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{45}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{column\PYZus{}names} \PY{o}{=} \PY{p}{(}
    \PY{n}{numeric\PYZus{}feats}
    \PY{o}{+} \PY{n}{ordinal\PYZus{}feats}
    \PY{o}{+} \PY{n}{passthrough\PYZus{}feats}    
    \PY{o}{+} \PY{n}{ct}\PY{o}{.}\PY{n}{named\PYZus{}transformers\PYZus{}}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{onehotencoder}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names\PYZus{}out}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{tolist}\PY{p}{(}\PY{p}{)}
\PY{p}{)}
\PY{n}{column\PYZus{}names}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{45}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
['university\_years',
 'lab1',
 'lab2',
 'lab3',
 'lab4',
 'quiz1',
 'class\_attendance',
 'ml\_experience',
 'major\_Biology',
 'major\_Computer Science',
 'major\_Economics',
 'major\_Linguistics',
 'major\_Mathematics',
 'major\_Mechanical Engineering',
 'major\_Physics',
 'major\_Psychology']
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{46}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{X\PYZus{}transformed}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{n}{column\PYZus{}names}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{46}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
    university\_years      lab1      lab2      lab3      lab4     quiz1  \textbackslash{}
0          -0.093454  0.358913  0.893260 -0.217334  0.362700  0.840028
1          -1.074719  0.590827  0.294251 -0.614206 -0.855972  0.712198
2          -0.093454 -1.264480 -0.704099 -0.316552 -1.312974 -0.693936
3          -0.093454  0.242957  0.000000  0.576409  0.362700  0.456537
4           0.887812 -1.380436 -1.103439  0.377973  0.515034 -0.054784
5           1.869077 -2.192133 -3.100139 -1.804821 -2.226978 -1.844409
6           0.887812 -1.032566 -0.105089  0.278755 -0.094302  0.712198
7          -0.093454  0.706783  0.893260 -1.705603 -1.465308 -1.333088
8          -1.074719  0.938697  0.294251  0.774844 -1.008306 -0.693936
9           0.887812  0.706783 -1.303109  0.774844  0.819702 -0.054784
10         -0.093454  1.054653 -0.504429  0.874062  0.972036 -0.949597
11         -2.055985  0.706783 -0.105089  0.675627  0.515034 -0.054784
12         -1.074719  1.054653  1.492270  0.973280  1.581372  1.862671
13          0.887812  0.706783  1.092930  0.973280  0.972036  1.862671
14         -0.093454  0.706783  0.294251  0.675627  0.972036 -1.972240
15         -0.093454  0.358913 -0.704099 -1.904039  0.819702  0.840028
16          1.869077 -1.612349  0.493921  0.675627 -0.398970 -0.054784
17         -0.093454 -0.336826  0.094581 -2.102474 -0.398970  0.200876
18         -1.074719  0.242957  0.000000  0.377973 -0.094302 -0.438275
19         -1.074719 -1.380436  1.092930  0.080319 -1.160640  0.456537
20          0.887812  0.822740  0.693590  0.576409  1.124370  0.200876

    class\_attendance  ml\_experience  major\_Biology  major\_Computer Science  \textbackslash{}
0                3.0            1.0            0.0                     1.0
1                1.0            1.0            0.0                     0.0
2                0.0            0.0            0.0                     0.0
3                3.0            0.0            0.0                     0.0
4                2.0            0.0            0.0                     0.0
5                2.0            1.0            0.0                     0.0
6                3.0            1.0            0.0                     1.0
7                0.0            0.0            0.0                     0.0
8                1.0            0.0            0.0                     0.0
9                1.0            1.0            0.0                     0.0
10               2.0            0.0            0.0                     0.0
11               1.0            1.0            0.0                     0.0
12               3.0            1.0            0.0                     0.0
13               3.0            0.0            0.0                     0.0
14               0.0            0.0            0.0                     0.0
15               2.0            1.0            0.0                     1.0
16               1.0            0.0            0.0                     1.0
17               1.0            1.0            0.0                     0.0
18               2.0            1.0            1.0                     0.0
19               0.0            0.0            0.0                     0.0
20               3.0            1.0            0.0                     0.0

    major\_Economics  major\_Linguistics  major\_Mathematics  \textbackslash{}
0               0.0                0.0                0.0
1               0.0                0.0                0.0
2               0.0                0.0                1.0
3               0.0                0.0                1.0
4               0.0                0.0                0.0
5               1.0                0.0                0.0
6               0.0                0.0                0.0
7               0.0                0.0                0.0
8               0.0                1.0                0.0
9               0.0                0.0                1.0
10              0.0                0.0                0.0
11              0.0                0.0                0.0
12              0.0                0.0                0.0
13              0.0                0.0                0.0
14              0.0                0.0                1.0
15              0.0                0.0                0.0
16              0.0                0.0                0.0
17              1.0                0.0                0.0
18              0.0                0.0                0.0
19              0.0                0.0                0.0
20              0.0                1.0                0.0

    major\_Mechanical Engineering  major\_Physics  major\_Psychology
0                            0.0            0.0               0.0
1                            1.0            0.0               0.0
2                            0.0            0.0               0.0
3                            0.0            0.0               0.0
4                            0.0            0.0               1.0
5                            0.0            0.0               0.0
6                            0.0            0.0               0.0
7                            1.0            0.0               0.0
8                            0.0            0.0               0.0
9                            0.0            0.0               0.0
10                           0.0            0.0               1.0
11                           0.0            1.0               0.0
12                           0.0            1.0               0.0
13                           1.0            0.0               0.0
14                           0.0            0.0               0.0
15                           0.0            0.0               0.0
16                           0.0            0.0               0.0
17                           0.0            0.0               0.0
18                           0.0            0.0               0.0
19                           0.0            0.0               1.0
20                           0.0            0.0               0.0
\end{Verbatim}
\end{tcolorbox}
        
    

    \subsubsection{Dealing with unknown
categories}\label{dealing-with-unknown-categories}

    Let's create a pipeline with the column transformer and pass it to
\texttt{cross\_validate}.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{47}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{pipe} \PY{o}{=} \PY{n}{make\PYZus{}pipeline}\PY{p}{(}\PY{n}{ct}\PY{p}{,} \PY{n}{SVC}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{48}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{scores} \PY{o}{=} \PY{n}{cross\PYZus{}validate}\PY{p}{(}\PY{n}{pipe}\PY{p}{,} \PY{n}{X}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{n}{return\PYZus{}train\PYZus{}score}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{scores}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
/Users/mathias/miniconda3/envs/cpsc330/lib/python3.10/site-
packages/sklearn/model\_selection/\_validation.py:988: UserWarning: Scoring
failed. The score on this train-test partition for these parameters will be set
to nan. Details:
Traceback (most recent call last):
  File "/Users/mathias/miniconda3/envs/cpsc330/lib/python3.10/site-
packages/sklearn/model\_selection/\_validation.py", line 977, in \_score
    scores = scorer(estimator, X\_test, y\_test, **score\_params)
  File "/Users/mathias/miniconda3/envs/cpsc330/lib/python3.10/site-
packages/sklearn/metrics/\_scorer.py", line 415, in \_\_call\_\_
    return estimator.score(*args, **kwargs)
  File "/Users/mathias/miniconda3/envs/cpsc330/lib/python3.10/site-
packages/sklearn/pipeline.py", line 993, in score
    Xt = transform.transform(Xt)
  File "/Users/mathias/miniconda3/envs/cpsc330/lib/python3.10/site-
packages/sklearn/utils/\_set\_output.py", line 273, in wrapped
    data\_to\_wrap = f(self, X, *args, **kwargs)
  File "/Users/mathias/miniconda3/envs/cpsc330/lib/python3.10/site-
packages/sklearn/compose/\_column\_transformer.py", line 1014, in transform
    Xs = self.\_call\_func\_on\_transformers(
  File "/Users/mathias/miniconda3/envs/cpsc330/lib/python3.10/site-
packages/sklearn/compose/\_column\_transformer.py", line 823, in
\_call\_func\_on\_transformers
    return Parallel(n\_jobs=self.n\_jobs)(jobs)
  File "/Users/mathias/miniconda3/envs/cpsc330/lib/python3.10/site-
packages/sklearn/utils/parallel.py", line 67, in \_\_call\_\_
    return super().\_\_call\_\_(iterable\_with\_config)
  File "/Users/mathias/miniconda3/envs/cpsc330/lib/python3.10/site-
packages/joblib/parallel.py", line 1863, in \_\_call\_\_
    return output if self.return\_generator else list(output)
  File "/Users/mathias/miniconda3/envs/cpsc330/lib/python3.10/site-
packages/joblib/parallel.py", line 1792, in \_get\_sequential\_output
    res = func(*args, **kwargs)
  File "/Users/mathias/miniconda3/envs/cpsc330/lib/python3.10/site-
packages/sklearn/utils/parallel.py", line 129, in \_\_call\_\_
    return self.function(*args, **kwargs)
  File "/Users/mathias/miniconda3/envs/cpsc330/lib/python3.10/site-
packages/sklearn/pipeline.py", line 1283, in \_transform\_one
    res = transformer.transform(X, **params.transform)
  File "/Users/mathias/miniconda3/envs/cpsc330/lib/python3.10/site-
packages/sklearn/utils/\_set\_output.py", line 273, in wrapped
    data\_to\_wrap = f(self, X, *args, **kwargs)
  File "/Users/mathias/miniconda3/envs/cpsc330/lib/python3.10/site-
packages/sklearn/preprocessing/\_encoders.py", line 1023, in transform
    X\_int, X\_mask = self.\_transform(
  File "/Users/mathias/miniconda3/envs/cpsc330/lib/python3.10/site-
packages/sklearn/preprocessing/\_encoders.py", line 213, in \_transform
    raise ValueError(msg)
ValueError: Found unknown categories ['Biology'] in column 0 during transform

  warnings.warn(
    \end{Verbatim}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{48}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
   fit\_time  score\_time  test\_score  train\_score
0  0.012661    0.004639        1.00     0.937500
1  0.005110    0.002457        1.00     0.941176
2  0.003547    0.002020        0.50     1.000000
3  0.003313    0.001715        0.75     0.941176
4  0.003514    0.007015         NaN     1.000000
\end{Verbatim}
\end{tcolorbox}
        
    \begin{itemize}
\tightlist
\item
  What's going on here??
\item
  Let's look at the error message:
  \texttt{ValueError:\ Found\ unknown\ categories\ {[}\textquotesingle{}Biology\textquotesingle{}{]}\ in\ column\ 0\ during\ transform}
\end{itemize}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{49}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{X}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{major}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{49}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
major
Computer Science          4
Mathematics               4
Mechanical Engineering    3
Psychology                3
Economics                 2
Linguistics               2
Physics                   2
Biology                   1
Name: count, dtype: int64
\end{Verbatim}
\end{tcolorbox}
        
    \begin{itemize}
\tightlist
\item
  There is only one instance of Biology.
\item
  During cross-validation, this is getting put into the validation
  split.
\item
  By default, \texttt{OneHotEncoder} throws an error because you might
  want to know about this.
\end{itemize}

    Simplest fix: - Pass \texttt{handle\_unknown="ignore"} argument to
\texttt{OneHotEncoder} - It creates a row with all zeros.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{50}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{ct} \PY{o}{=} \PY{n}{make\PYZus{}column\PYZus{}transformer}\PY{p}{(}
    \PY{p}{(}
        \PY{n}{make\PYZus{}pipeline}\PY{p}{(}\PY{n}{SimpleImputer}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{StandardScaler}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{,}
        \PY{n}{numeric\PYZus{}feats}\PY{p}{,}
    \PY{p}{)}\PY{p}{,}  \PY{c+c1}{\PYZsh{} scaling on numeric features}
    \PY{p}{(}
        \PY{n}{OrdinalEncoder}\PY{p}{(}\PY{n}{categories}\PY{o}{=}\PY{p}{[}\PY{n}{class\PYZus{}attendance\PYZus{}levels}\PY{p}{]}\PY{p}{,} \PY{n}{dtype}\PY{o}{=}\PY{n+nb}{int}\PY{p}{)}\PY{p}{,}
        \PY{n}{ordinal\PYZus{}feats}\PY{p}{,}
    \PY{p}{)}\PY{p}{,}  \PY{c+c1}{\PYZsh{} Ordinal encoding on ordinal features}
    \PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{passthrough}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{passthrough\PYZus{}feats}\PY{p}{)}\PY{p}{,}  \PY{c+c1}{\PYZsh{} no transformations on the binary features}
    \PY{p}{(}
        \PY{n}{OneHotEncoder}\PY{p}{(}\PY{n}{handle\PYZus{}unknown}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ignore}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,}
        \PY{n}{categorical\PYZus{}feats}\PY{p}{,}
    \PY{p}{)}\PY{p}{,}  \PY{c+c1}{\PYZsh{} OHE on categorical features    }
    \PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{drop}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{drop\PYZus{}feats}\PY{p}{)}\PY{p}{,}  \PY{c+c1}{\PYZsh{} drop the drop features}
\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{51}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{ct}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{51}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
ColumnTransformer(transformers=[('pipeline',
                                 Pipeline(steps=[('simpleimputer',
                                                  SimpleImputer()),
                                                 ('standardscaler',
                                                  StandardScaler())]),
                                 ['university\_years', 'lab1', 'lab2', 'lab3',
                                  'lab4', 'quiz1']),
                                ('ordinalencoder',
                                 OrdinalEncoder(categories=[['Poor', 'Average',
                                                             'Good',
                                                             'Excellent']],
                                                dtype=<class 'int'>),
                                 ['class\_attendance']),
                                ('passthrough', 'passthrough',
                                 ['ml\_experience']),
                                ('onehotencoder',
                                 OneHotEncoder(handle\_unknown='ignore'),
                                 ['major']),
                                ('drop', 'drop', ['enjoy\_course'])])
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{52}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{pipe} \PY{o}{=} \PY{n}{make\PYZus{}pipeline}\PY{p}{(}\PY{n}{ct}\PY{p}{,} \PY{n}{SVC}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{53}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{scores} \PY{o}{=} \PY{n}{cross\PYZus{}validate}\PY{p}{(}\PY{n}{pipe}\PY{p}{,} \PY{n}{X}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{n}{cv}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{,} \PY{n}{return\PYZus{}train\PYZus{}score}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{scores}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{53}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
   fit\_time  score\_time  test\_score  train\_score
0  0.012290    0.006207        1.00     0.937500
1  0.004055    0.002097        1.00     0.941176
2  0.003867    0.001859        0.50     1.000000
3  0.003571    0.001940        0.75     0.941176
4  0.003814    0.001853        0.75     1.000000
\end{Verbatim}
\end{tcolorbox}
        
    \begin{itemize}
\tightlist
\item
  With this approach, all unknown categories will be represented with
  all zeros and cross-validation is running OK now.
\end{itemize}

Ask yourself the following questions when you work with categorical
variables\\
- Do you want this behaviour? - Are you expecting to get many unknown
categories? Do you want to be able to distinguish between them?

    \paragraph{Cases where it's OK to break the golden
rule}\label{cases-where-its-ok-to-break-the-golden-rule}

\begin{itemize}
\tightlist
\item
  If it's some fix number of categories. For example, if it's something
  like provinces in Canada or majors taught at UBC. We know the
  categories in advance and this is one of the cases where it might be
  OK to violate the golden rule and get a list of all possible values
  for the categorical variable.
\end{itemize}

    

    \subsubsection{Categorical features with only two possible
categories}\label{categorical-features-with-only-two-possible-categories}

\begin{itemize}
\tightlist
\item
  Sometimes you have features with only two possible categories.
\item
  If we apply \texttt{OheHotEncoder} on such columns, it'll create two
  columns, which seems wasteful, as we could represent all information
  in the column in just one column with say 0's and 1's with presence of
  absence of one of the categories.
\item
  You can pass \texttt{drop="if\_binary"} argument to
  \texttt{OneHotEncoder} in order to create only one column in such
  scenario.
\end{itemize}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{54}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{X}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{enjoy\PYZus{}course}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{54}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
0    yes
1    yes
2    yes
3     no
4    yes
Name: enjoy\_course, dtype: object
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{55}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{ohe\PYZus{}enc} \PY{o}{=} \PY{n}{OneHotEncoder}\PY{p}{(}\PY{n}{drop}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{if\PYZus{}binary}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{dtype}\PY{o}{=}\PY{n+nb}{int}\PY{p}{,} \PY{n}{sparse\PYZus{}output}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
\PY{n}{ohe\PYZus{}enc}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X}\PY{p}{[}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{enjoy\PYZus{}course}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{]}\PY{p}{)}
\PY{n}{transformed} \PY{o}{=} \PY{n}{ohe\PYZus{}enc}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X}\PY{p}{[}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{enjoy\PYZus{}course}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{]}\PY{p}{)}
\PY{n}{df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{data}\PY{o}{=}\PY{n}{transformed}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{enjoy\PYZus{}course\PYZus{}enc}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{n}{X}\PY{o}{.}\PY{n}{index}\PY{p}{)}
\PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{[}\PY{n}{X}\PY{p}{[}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{enjoy\PYZus{}course}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{n}{df}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{55}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
  enjoy\_course  enjoy\_course\_enc
0          yes                 1
1          yes                 1
2          yes                 1
3           no                 0
4          yes                 1
5           no                 0
6          yes                 1
7           no                 0
8           no                 0
9          yes                 1
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{56}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{numeric\PYZus{}feats} \PY{o}{=} \PY{p}{[}
    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{university\PYZus{}years}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{lab1}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{lab2}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{lab3}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{lab4}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{quiz1}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
\PY{p}{]}  \PY{c+c1}{\PYZsh{} apply scaling}
\PY{n}{categorical\PYZus{}feats} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{major}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}  \PY{c+c1}{\PYZsh{} apply one\PYZhy{}hot encoding}
\PY{n}{ordinal\PYZus{}feats} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{class\PYZus{}attendance}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}  \PY{c+c1}{\PYZsh{} apply ordinal encoding}
\PY{n}{binary\PYZus{}feats} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{enjoy\PYZus{}course}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}  \PY{c+c1}{\PYZsh{} apply one\PYZhy{}hot encoding with drop=\PYZdq{}if\PYZus{}binary\PYZdq{}}
\PY{n}{passthrough\PYZus{}feats} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ml\PYZus{}experience}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}  \PY{c+c1}{\PYZsh{} do not apply any transformation}
\PY{n}{drop\PYZus{}feats} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{57}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{ct} \PY{o}{=} \PY{n}{make\PYZus{}column\PYZus{}transformer}\PY{p}{(}
    \PY{p}{(}
        \PY{n}{make\PYZus{}pipeline}\PY{p}{(}\PY{n}{SimpleImputer}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{StandardScaler}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{,}
        \PY{n}{numeric\PYZus{}feats}\PY{p}{,}
    \PY{p}{)}\PY{p}{,}  \PY{c+c1}{\PYZsh{} scaling on numeric features}
    \PY{p}{(}
        \PY{n}{OrdinalEncoder}\PY{p}{(}\PY{n}{categories}\PY{o}{=}\PY{p}{[}\PY{n}{class\PYZus{}attendance\PYZus{}levels}\PY{p}{]}\PY{p}{,} \PY{n}{dtype}\PY{o}{=}\PY{n+nb}{int}\PY{p}{)}\PY{p}{,}
        \PY{n}{ordinal\PYZus{}feats}\PY{p}{,}
    \PY{p}{)}\PY{p}{,}  \PY{c+c1}{\PYZsh{} Ordinal encoding on ordinal features}
    \PY{p}{(}
        \PY{n}{OneHotEncoder}\PY{p}{(}\PY{n}{drop}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{if\PYZus{}binary}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{dtype}\PY{o}{=}\PY{n+nb}{int}\PY{p}{)}\PY{p}{,}
        \PY{n}{binary\PYZus{}feats}\PY{p}{,}
    \PY{p}{)}\PY{p}{,}  \PY{c+c1}{\PYZsh{} OHE on categorical features}
    \PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{passthrough}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{passthrough\PYZus{}feats}\PY{p}{)}\PY{p}{,}  \PY{c+c1}{\PYZsh{} no transformations on the binary features    }
    \PY{p}{(}
        \PY{n}{OneHotEncoder}\PY{p}{(}\PY{n}{handle\PYZus{}unknown}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ignore}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,}
        \PY{n}{categorical\PYZus{}feats}\PY{p}{,}
    \PY{p}{)}\PY{p}{,}  \PY{c+c1}{\PYZsh{} OHE on categorical features}
\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{58}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{ct}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{58}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
ColumnTransformer(transformers=[('pipeline',
                                 Pipeline(steps=[('simpleimputer',
                                                  SimpleImputer()),
                                                 ('standardscaler',
                                                  StandardScaler())]),
                                 ['university\_years', 'lab1', 'lab2', 'lab3',
                                  'lab4', 'quiz1']),
                                ('ordinalencoder',
                                 OrdinalEncoder(categories=[['Poor', 'Average',
                                                             'Good',
                                                             'Excellent']],
                                                dtype=<class 'int'>),
                                 ['class\_attendance']),
                                ('onehotencoder-1',
                                 OneHotEncoder(drop='if\_binary',
                                               dtype=<class 'int'>),
                                 ['enjoy\_course']),
                                ('passthrough', 'passthrough',
                                 ['ml\_experience']),
                                ('onehotencoder-2',
                                 OneHotEncoder(handle\_unknown='ignore'),
                                 ['major'])])
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{59}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{pipe} \PY{o}{=} \PY{n}{make\PYZus{}pipeline}\PY{p}{(}\PY{n}{ct}\PY{p}{,} \PY{n}{SVC}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{60}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{scores} \PY{o}{=} \PY{n}{cross\PYZus{}validate}\PY{p}{(}\PY{n}{pipe}\PY{p}{,} \PY{n}{X}\PY{p}{,} \PY{n}{y}\PY{p}{,} \PY{n}{cv}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{,} \PY{n}{return\PYZus{}train\PYZus{}score}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{scores}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{60}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
   fit\_time  score\_time  test\_score  train\_score
0  0.011334    0.007411        1.00     1.000000
1  0.004439    0.002036        1.00     0.941176
2  0.003873    0.002056        0.50     1.000000
3  0.004243    0.002228        1.00     0.941176
4  0.004302    0.002381        0.75     1.000000
\end{Verbatim}
\end{tcolorbox}
        
    \texttt{\{note\}\ Do\ not\ read\ too\ much\ into\ the\ scores,\ as\ we\ are\ running\ cross-validation\ on\ a\ very\ small\ dataset\ with\ 21\ examples.\ The\ main\ point\ here\ is\ to\ show\ you\ how\ can\ we\ use\ \textasciigrave{}ColumnTransformer\textasciigrave{}\ to\ apply\ different\ transformations\ on\ different\ columns.}

    \subsection{Break (5 min)}\label{break-5-min}

\includegraphics{/Users/charleenchu/Desktop/school/cpsc330-2023W2/lectures/img/eva-coffee.png}

    

    \subsection{\texorpdfstring{\texttt{ColumnTransformer} on the California
housing
dataset}{ColumnTransformer on the California housing dataset}}\label{columntransformer-on-the-california-housing-dataset}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{63}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{housing\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{../data/housing.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{train\PYZus{}df}\PY{p}{,} \PY{n}{test\PYZus{}df} \PY{o}{=} \PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{(}\PY{n}{housing\PYZus{}df}\PY{p}{,} \PY{n}{test\PYZus{}size}\PY{o}{=}\PY{l+m+mf}{0.1}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{123}\PY{p}{)}

\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{63}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
       longitude  latitude  housing\_median\_age  total\_rooms  total\_bedrooms  \textbackslash{}
6051     -117.75     34.04                22.0       2948.0           636.0
20113    -119.57     37.94                17.0        346.0           130.0
14289    -117.13     32.74                46.0       3355.0           768.0
13665    -117.31     34.02                18.0       1634.0           274.0
14471    -117.23     32.88                18.0       5566.0          1465.0

       population  households  median\_income  median\_house\_value  \textbackslash{}
6051       2600.0       602.0         3.1250            113600.0
20113        51.0        20.0         3.4861            137500.0
14289      1457.0       708.0         2.6604            170100.0
13665       899.0       285.0         5.2139            129300.0
14471      6303.0      1458.0         1.8580            205000.0

      ocean\_proximity
6051           INLAND
20113          INLAND
14289      NEAR OCEAN
13665          INLAND
14471      NEAR OCEAN
\end{Verbatim}
\end{tcolorbox}
        
    Some column values are mean/median but some are not.

    Let's add some new features to the dataset which could help predicting
the target: \texttt{median\_house\_value}.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{64}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{train\PYZus{}df} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{assign}\PY{p}{(}
    \PY{n}{rooms\PYZus{}per\PYZus{}household}\PY{o}{=}\PY{n}{train\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{total\PYZus{}rooms}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{/} \PY{n}{train\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{households}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
\PY{p}{)}
\PY{n}{test\PYZus{}df} \PY{o}{=} \PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{assign}\PY{p}{(}
    \PY{n}{rooms\PYZus{}per\PYZus{}household}\PY{o}{=}\PY{n}{test\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{total\PYZus{}rooms}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{/} \PY{n}{test\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{households}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
\PY{p}{)}

\PY{n}{train\PYZus{}df} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{assign}\PY{p}{(}
    \PY{n}{bedrooms\PYZus{}per\PYZus{}household}\PY{o}{=}\PY{n}{train\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{total\PYZus{}bedrooms}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{/} \PY{n}{train\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{households}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
\PY{p}{)}
\PY{n}{test\PYZus{}df} \PY{o}{=} \PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{assign}\PY{p}{(}
    \PY{n}{bedrooms\PYZus{}per\PYZus{}household}\PY{o}{=}\PY{n}{test\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{total\PYZus{}bedrooms}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{/} \PY{n}{test\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{households}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
\PY{p}{)}

\PY{n}{train\PYZus{}df} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{assign}\PY{p}{(}
    \PY{n}{population\PYZus{}per\PYZus{}household}\PY{o}{=}\PY{n}{train\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{population}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{/} \PY{n}{train\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{households}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
\PY{p}{)}
\PY{n}{test\PYZus{}df} \PY{o}{=} \PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{assign}\PY{p}{(}
    \PY{n}{population\PYZus{}per\PYZus{}household}\PY{o}{=}\PY{n}{test\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{population}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{/} \PY{n}{test\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{households}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{65}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{65}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
       longitude  latitude  housing\_median\_age  total\_rooms  total\_bedrooms  \textbackslash{}
6051     -117.75     34.04                22.0       2948.0           636.0
20113    -119.57     37.94                17.0        346.0           130.0
14289    -117.13     32.74                46.0       3355.0           768.0
13665    -117.31     34.02                18.0       1634.0           274.0
14471    -117.23     32.88                18.0       5566.0          1465.0

       population  households  median\_income  median\_house\_value  \textbackslash{}
6051       2600.0       602.0         3.1250            113600.0
20113        51.0        20.0         3.4861            137500.0
14289      1457.0       708.0         2.6604            170100.0
13665       899.0       285.0         5.2139            129300.0
14471      6303.0      1458.0         1.8580            205000.0

      ocean\_proximity  rooms\_per\_household  bedrooms\_per\_household  \textbackslash{}
6051           INLAND             4.897010                1.056478
20113          INLAND            17.300000                6.500000
14289      NEAR OCEAN             4.738701                1.084746
13665          INLAND             5.733333                0.961404
14471      NEAR OCEAN             3.817558                1.004801

       population\_per\_household
6051                   4.318937
20113                  2.550000
14289                  2.057910
13665                  3.154386
14471                  4.323045
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{66}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Let\PYZsq{}s keep both numeric and categorical columns in the data.}
\PY{n}{X\PYZus{}train} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{median\PYZus{}house\PYZus{}value}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{total\PYZus{}rooms}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{total\PYZus{}bedrooms}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{population}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
\PY{n}{y\PYZus{}train} \PY{o}{=} \PY{n}{train\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{median\PYZus{}house\PYZus{}value}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}

\PY{n}{X\PYZus{}test} \PY{o}{=} \PY{n}{test\PYZus{}df}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{median\PYZus{}house\PYZus{}value}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{total\PYZus{}rooms}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{total\PYZus{}bedrooms}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{population}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
\PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{test\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{median\PYZus{}house\PYZus{}value}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{67}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{compose} \PY{k+kn}{import} \PY{n}{ColumnTransformer}\PY{p}{,} \PY{n}{make\PYZus{}column\PYZus{}transformer}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{68}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{68}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
       longitude  latitude  housing\_median\_age  households  median\_income  \textbackslash{}
6051     -117.75     34.04                22.0       602.0         3.1250
20113    -119.57     37.94                17.0        20.0         3.4861
14289    -117.13     32.74                46.0       708.0         2.6604
13665    -117.31     34.02                18.0       285.0         5.2139
14471    -117.23     32.88                18.0      1458.0         1.8580
9730     -121.74     36.79                16.0       611.0         4.3814
14690    -117.09     32.80                36.0       360.0         4.7188
7938     -118.11     33.86                33.0       393.0         5.3889
18365    -122.12     37.28                21.0        56.0         5.8691
10931    -117.91     33.74                25.0       922.0         2.9926

      ocean\_proximity  rooms\_per\_household  bedrooms\_per\_household  \textbackslash{}
6051           INLAND             4.897010                1.056478
20113          INLAND            17.300000                6.500000
14289      NEAR OCEAN             4.738701                1.084746
13665          INLAND             5.733333                0.961404
14471      NEAR OCEAN             3.817558                1.004801
9730        <1H OCEAN             6.286416                1.014730
14690      NEAR OCEAN             6.008333                1.019444
7938        <1H OCEAN             6.078880                1.043257
18365       <1H OCEAN             6.232143                1.142857
10931       <1H OCEAN             4.634490                1.046638

       population\_per\_household
6051                   4.318937
20113                  2.550000
14289                  2.057910
13665                  3.154386
14471                  4.323045
9730                   2.944354
14690                  2.541667
7938                   3.127226
18365                  2.660714
10931                  3.195228
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{69}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{columns}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{69}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
Index(['longitude', 'latitude', 'housing\_median\_age', 'households',
       'median\_income', 'ocean\_proximity', 'rooms\_per\_household',
       'bedrooms\_per\_household', 'population\_per\_household'],
      dtype='object')
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{70}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Identify the categorical and numeric columns}
\PY{n}{numeric\PYZus{}features} \PY{o}{=} \PY{p}{[}
    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{longitude}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{latitude}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{housing\PYZus{}median\PYZus{}age}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{households}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{median\PYZus{}income}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{rooms\PYZus{}per\PYZus{}household}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{bedrooms\PYZus{}per\PYZus{}household}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{population\PYZus{}per\PYZus{}household}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
\PY{p}{]}

\PY{n}{categorical\PYZus{}features} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ocean\PYZus{}proximity}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
\PY{n}{target} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{median\PYZus{}income}\PY{l+s+s2}{\PYZdq{}}
\end{Verbatim}
\end{tcolorbox}

    \begin{itemize}
\tightlist
\item
  Let's create a \texttt{ColumnTransformer} for our dataset.
\end{itemize}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{71}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{info}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
<class 'pandas.core.frame.DataFrame'>
Index: 18576 entries, 6051 to 19966
Data columns (total 9 columns):
 \#   Column                    Non-Null Count  Dtype
---  ------                    --------------  -----
 0   longitude                 18576 non-null  float64
 1   latitude                  18576 non-null  float64
 2   housing\_median\_age        18576 non-null  float64
 3   households                18576 non-null  float64
 4   median\_income             18576 non-null  float64
 5   ocean\_proximity           18576 non-null  object
 6   rooms\_per\_household       18576 non-null  float64
 7   bedrooms\_per\_household    18391 non-null  float64
 8   population\_per\_household  18576 non-null  float64
dtypes: float64(8), object(1)
memory usage: 1.4+ MB
    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{72}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{X\PYZus{}train}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ocean\PYZus{}proximity}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{72}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
ocean\_proximity
<1H OCEAN     8221
INLAND        5915
NEAR OCEAN    2389
NEAR BAY      2046
ISLAND           5
Name: count, dtype: int64
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{73}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{numeric\PYZus{}transformer} \PY{o}{=} \PY{n}{make\PYZus{}pipeline}\PY{p}{(}\PY{n}{SimpleImputer}\PY{p}{(}\PY{n}{strategy}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{median}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{,} \PY{n}{StandardScaler}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\PY{n}{categorical\PYZus{}transformer} \PY{o}{=} \PY{n}{OneHotEncoder}\PY{p}{(}\PY{n}{handle\PYZus{}unknown}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ignore}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}

\PY{n}{preprocessor} \PY{o}{=} \PY{n}{make\PYZus{}column\PYZus{}transformer}\PY{p}{(}
    \PY{p}{(}\PY{n}{numeric\PYZus{}transformer}\PY{p}{,} \PY{n}{numeric\PYZus{}features}\PY{p}{)}\PY{p}{,}
    \PY{p}{(}\PY{n}{categorical\PYZus{}transformer}\PY{p}{,} \PY{n}{categorical\PYZus{}features}\PY{p}{)}\PY{p}{,}
\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{74}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{preprocessor}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{74}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
ColumnTransformer(transformers=[('pipeline',
                                 Pipeline(steps=[('simpleimputer',
SimpleImputer(strategy='median')),
                                                 ('standardscaler',
                                                  StandardScaler())]),
                                 ['longitude', 'latitude', 'housing\_median\_age',
                                  'households', 'median\_income',
                                  'rooms\_per\_household',
                                  'bedrooms\_per\_household',
                                  'population\_per\_household']),
                                ('onehotencoder',
                                 OneHotEncoder(handle\_unknown='ignore'),
                                 ['ocean\_proximity'])])
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{75}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{X\PYZus{}train\PYZus{}pp} \PY{o}{=} \PY{n}{preprocessor}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{itemize}
\tightlist
\item
  When we \texttt{fit} the preprocessor, it calls \texttt{fit} on
  \emph{all} the transformers
\item
  When we \texttt{transform} the preprocessor, it calls
  \texttt{transform} on \emph{all} the transformers.
\end{itemize}

    We can get the new names of the columns that were generated by the
one-hot encoding:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{76}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{preprocessor}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{76}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
ColumnTransformer(transformers=[('pipeline',
                                 Pipeline(steps=[('simpleimputer',
SimpleImputer(strategy='median')),
                                                 ('standardscaler',
                                                  StandardScaler())]),
                                 ['longitude', 'latitude', 'housing\_median\_age',
                                  'households', 'median\_income',
                                  'rooms\_per\_household',
                                  'bedrooms\_per\_household',
                                  'population\_per\_household']),
                                ('onehotencoder',
                                 OneHotEncoder(handle\_unknown='ignore'),
                                 ['ocean\_proximity'])])
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{77}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{preprocessor}\PY{o}{.}\PY{n}{named\PYZus{}transformers\PYZus{}}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{onehotencoder}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names\PYZus{}out}\PY{p}{(}
    \PY{n}{categorical\PYZus{}features}
\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{77}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
array(['ocean\_proximity\_<1H OCEAN', 'ocean\_proximity\_INLAND',
       'ocean\_proximity\_ISLAND', 'ocean\_proximity\_NEAR BAY',
       'ocean\_proximity\_NEAR OCEAN'], dtype=object)
\end{Verbatim}
\end{tcolorbox}
        
    Combining this with the numeric feature names gives us all the column
names:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{78}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{column\PYZus{}names} \PY{o}{=} \PY{n}{numeric\PYZus{}features} \PY{o}{+} \PY{n+nb}{list}\PY{p}{(}
    \PY{n}{preprocessor}\PY{o}{.}\PY{n}{named\PYZus{}transformers\PYZus{}}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{onehotencoder}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names\PYZus{}out}\PY{p}{(}
        \PY{n}{categorical\PYZus{}features}
    \PY{p}{)}
\PY{p}{)}
\PY{n}{column\PYZus{}names}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{78}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
['longitude',
 'latitude',
 'housing\_median\_age',
 'households',
 'median\_income',
 'rooms\_per\_household',
 'bedrooms\_per\_household',
 'population\_per\_household',
 'ocean\_proximity\_<1H OCEAN',
 'ocean\_proximity\_INLAND',
 'ocean\_proximity\_ISLAND',
 'ocean\_proximity\_NEAR BAY',
 'ocean\_proximity\_NEAR OCEAN']
\end{Verbatim}
\end{tcolorbox}
        
    Let's visualize the preprocessed training data as a dataframe.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{79}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}pp}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{n}{column\PYZus{}names}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{79}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
       longitude  latitude  housing\_median\_age  households  median\_income  \textbackslash{}
0       0.908140 -0.743917           -0.526078    0.266135      -0.389736
1      -0.002057  1.083123           -0.923283   -1.253312      -0.198924
2       1.218207 -1.352930            1.380504    0.542873      -0.635239
3       1.128188 -0.753286           -0.843842   -0.561467       0.714077
4       1.168196 -1.287344           -0.843842    2.500924      -1.059242
{\ldots}          {\ldots}       {\ldots}                 {\ldots}         {\ldots}            {\ldots}
18571   0.733102 -0.804818            0.586095   -0.966131      -0.118182
18572   1.163195 -1.057793           -1.161606    0.728235       0.357500
18573  -1.097293  0.797355           -1.876574    0.514155       0.934269
18574  -1.437367  1.008167            1.221622   -0.454427       0.006578
18575   0.242996  0.272667           -0.684960   -0.396991      -0.711754

       rooms\_per\_household  bedrooms\_per\_household  population\_per\_household  \textbackslash{}
0                -0.210591               -0.083813                  0.126398
1                 4.726412               11.166631                 -0.050132
2                -0.273606               -0.025391                 -0.099240
3                 0.122307               -0.280310                  0.010183
4                -0.640266               -0.190617                  0.126808
{\ldots}                    {\ldots}                     {\ldots}                       {\ldots}
18571             0.063110               -0.099558                  0.071541
18572             0.235096               -0.163397                  0.007458
18573             0.211892               -0.135305                  0.044029
18574            -0.273382               -0.149822                 -0.132875
18575             0.025998                0.042957                  0.051269

       ocean\_proximity\_<1H OCEAN  ocean\_proximity\_INLAND  \textbackslash{}
0                            0.0                     1.0
1                            0.0                     1.0
2                            0.0                     0.0
3                            0.0                     1.0
4                            0.0                     0.0
{\ldots}                          {\ldots}                     {\ldots}
18571                        1.0                     0.0
18572                        1.0                     0.0
18573                        1.0                     0.0
18574                        0.0                     0.0
18575                        0.0                     1.0

       ocean\_proximity\_ISLAND  ocean\_proximity\_NEAR BAY  \textbackslash{}
0                         0.0                       0.0
1                         0.0                       0.0
2                         0.0                       0.0
3                         0.0                       0.0
4                         0.0                       0.0
{\ldots}                       {\ldots}                       {\ldots}
18571                     0.0                       0.0
18572                     0.0                       0.0
18573                     0.0                       0.0
18574                     0.0                       1.0
18575                     0.0                       0.0

       ocean\_proximity\_NEAR OCEAN
0                             0.0
1                             0.0
2                             1.0
3                             0.0
4                             1.0
{\ldots}                           {\ldots}
18571                         0.0
18572                         0.0
18573                         0.0
18574                         0.0
18575                         0.0

[18576 rows x 13 columns]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{80}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{results\PYZus{}dict} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
\PY{n}{dummy} \PY{o}{=} \PY{n}{DummyRegressor}\PY{p}{(}\PY{p}{)}
\PY{n}{results\PYZus{}dict}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dummy}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{mean\PYZus{}std\PYZus{}cross\PYZus{}val\PYZus{}scores}\PY{p}{(}
    \PY{n}{dummy}\PY{p}{,} \PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{return\PYZus{}train\PYZus{}score}\PY{o}{=}\PY{k+kc}{True}
\PY{p}{)}
\PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{results\PYZus{}dict}\PY{p}{)}\PY{o}{.}\PY{n}{T}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{80}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
                fit\_time         score\_time          test\_score  \textbackslash{}
dummy  0.002 (+/- 0.001)  0.001 (+/- 0.000)  -0.001 (+/- 0.001)

             train\_score
dummy  0.000 (+/- 0.000)
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{81}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{svm} \PY{k+kn}{import} \PY{n}{SVR}

\PY{n}{knn\PYZus{}pipe} \PY{o}{=} \PY{n}{make\PYZus{}pipeline}\PY{p}{(}\PY{n}{preprocessor}\PY{p}{,} \PY{n}{KNeighborsRegressor}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{82}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{knn\PYZus{}pipe}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{82}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
Pipeline(steps=[('columntransformer',
                 ColumnTransformer(transformers=[('pipeline',
Pipeline(steps=[('simpleimputer',
SimpleImputer(strategy='median')),
('standardscaler',
StandardScaler())]),
                                                  ['longitude', 'latitude',
                                                   'housing\_median\_age',
                                                   'households',
                                                   'median\_income',
                                                   'rooms\_per\_household',
                                                   'bedrooms\_per\_household',
                                                   'population\_per\_household']),
                                                 ('onehotencoder',
OneHotEncoder(handle\_unknown='ignore'),
                                                  ['ocean\_proximity'])])),
                ('kneighborsregressor', KNeighborsRegressor())])
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{83}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{results\PYZus{}dict}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{imp + scaling + ohe + KNN}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{mean\PYZus{}std\PYZus{}cross\PYZus{}val\PYZus{}scores}\PY{p}{(}
    \PY{n}{knn\PYZus{}pipe}\PY{p}{,} \PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{return\PYZus{}train\PYZus{}score}\PY{o}{=}\PY{k+kc}{True}
\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{84}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{results\PYZus{}dict}\PY{p}{)}\PY{o}{.}\PY{n}{T}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{84}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
                                    fit\_time         score\_time  \textbackslash{}
dummy                      0.002 (+/- 0.001)  0.001 (+/- 0.000)
imp + scaling + ohe + KNN  0.018 (+/- 0.007)  0.115 (+/- 0.013)

                                   test\_score        train\_score
dummy                      -0.001 (+/- 0.001)  0.000 (+/- 0.000)
imp + scaling + ohe + KNN   0.706 (+/- 0.015)  0.806 (+/- 0.015)
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{85}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{svr\PYZus{}pipe} \PY{o}{=} \PY{n}{make\PYZus{}pipeline}\PY{p}{(}\PY{n}{preprocessor}\PY{p}{,} \PY{n}{SVR}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\PY{n}{results\PYZus{}dict}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{imp + scaling + ohe + SVR (default)}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{mean\PYZus{}std\PYZus{}cross\PYZus{}val\PYZus{}scores}\PY{p}{(}
    \PY{n}{svr\PYZus{}pipe}\PY{p}{,} \PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{return\PYZus{}train\PYZus{}score}\PY{o}{=}\PY{k+kc}{True}
\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{86}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{results\PYZus{}dict}\PY{p}{)}\PY{o}{.}\PY{n}{T}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{86}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
                                              fit\_time         score\_time  \textbackslash{}
dummy                                0.002 (+/- 0.001)  0.001 (+/- 0.000)
imp + scaling + ohe + KNN            0.018 (+/- 0.007)  0.115 (+/- 0.013)
imp + scaling + ohe + SVR (default)  5.540 (+/- 0.043)  1.631 (+/- 0.014)

                                             test\_score         train\_score
dummy                                -0.001 (+/- 0.001)   0.000 (+/- 0.000)
imp + scaling + ohe + KNN             0.706 (+/- 0.015)   0.806 (+/- 0.015)
imp + scaling + ohe + SVR (default)  -0.049 (+/- 0.012)  -0.048 (+/- 0.001)
\end{Verbatim}
\end{tcolorbox}
        
    The results with \texttt{scikit-learn}'s default SVR hyperparameters are
pretty bad.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{87}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{svr\PYZus{}C\PYZus{}pipe} \PY{o}{=} \PY{n}{make\PYZus{}pipeline}\PY{p}{(}\PY{n}{preprocessor}\PY{p}{,} \PY{n}{SVR}\PY{p}{(}\PY{n}{C}\PY{o}{=}\PY{l+m+mi}{10000}\PY{p}{)}\PY{p}{)}
\PY{n}{results\PYZus{}dict}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{imp + scaling + ohe + SVR (C=10000)}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{mean\PYZus{}std\PYZus{}cross\PYZus{}val\PYZus{}scores}\PY{p}{(}
    \PY{n}{svr\PYZus{}C\PYZus{}pipe}\PY{p}{,} \PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{return\PYZus{}train\PYZus{}score}\PY{o}{=}\PY{k+kc}{True}
\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{88}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{results\PYZus{}dict}\PY{p}{)}\PY{o}{.}\PY{n}{T}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{88}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
                                              fit\_time         score\_time  \textbackslash{}
dummy                                0.002 (+/- 0.001)  0.001 (+/- 0.000)
imp + scaling + ohe + KNN            0.018 (+/- 0.007)  0.115 (+/- 0.013)
imp + scaling + ohe + SVR (default)  5.540 (+/- 0.043)  1.631 (+/- 0.014)
imp + scaling + ohe + SVR (C=10000)  5.155 (+/- 0.076)  1.668 (+/- 0.003)

                                             test\_score         train\_score
dummy                                -0.001 (+/- 0.001)   0.000 (+/- 0.000)
imp + scaling + ohe + KNN             0.706 (+/- 0.015)   0.806 (+/- 0.015)
imp + scaling + ohe + SVR (default)  -0.049 (+/- 0.012)  -0.048 (+/- 0.001)
imp + scaling + ohe + SVR (C=10000)   0.708 (+/- 0.011)   0.713 (+/- 0.017)
\end{Verbatim}
\end{tcolorbox}
        
    With a bigger value for \texttt{C} the results are much better. We need
to carry out systematic hyperparameter optimization to get better
results. (Coming up soon.)

    \begin{itemize}
\tightlist
\item
  Note that categorical features are different than free text features.
  Sometimes there are columns containing free text information and we
  we'll look at ways to deal with them in the later part of this
  lecture.
\end{itemize}

    \subsubsection{OHE with many categories}\label{ohe-with-many-categories}

    \begin{itemize}
\tightlist
\item
  Do we have enough data for rare categories to learn anything
  meaningful?
\item
  How about grouping them into bigger categories?

  \begin{itemize}
  \tightlist
  \item
    Example: country names into continents such as ``South America'' or
    ``Asia''
  \end{itemize}
\item
  Or having ``other'' category for rare cases?
\end{itemize}

    \subsubsection{Do we actually want to use certain features for
prediction?}\label{do-we-actually-want-to-use-certain-features-for-prediction}

\begin{itemize}
\tightlist
\item
  Do you want to use certain features such as \textbf{gender} or
  \textbf{race} in prediction?
\item
  Remember that the systems you build are going to be used in some
  applications.
\item
  It's extremely important to be mindful of the consequences of
  including certain features in your predictive model.
\end{itemize}

    \subsubsection{Preprocessing the
targets?}\label{preprocessing-the-targets}

\begin{itemize}
\tightlist
\item
  Generally no need for this when doing classification.
\item
  In regression it makes sense in some cases. More on this later.
\item
  \texttt{sklearn} is fine with categorical labels (\(y\)-values) for
  classification problems.
\end{itemize}

    

    \subsection{Encoding text data}\label{encoding-text-data}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{89}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{toy\PYZus{}spam} \PY{o}{=} \PY{p}{[}
    \PY{p}{[}
        \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{URGENT!! As a valued network customer you have been selected to receive a Â£900 prize reward!}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
        \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{spam}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
    \PY{p}{]}\PY{p}{,}
    \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Lol you are always so convincing.}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{non spam}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,}
    \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Nah I don}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{t think he goes to usf, he lives around here though}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{non spam}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,}
    \PY{p}{[}
        \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
        \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{spam}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
    \PY{p}{]}\PY{p}{,}
    \PY{p}{[}
        \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Had your mobile 11 months or more? U R entitled to Update to the latest colour mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
        \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{spam}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
    \PY{p}{]}\PY{p}{,}
    \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Congrats! I can}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{t wait to see you!!}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{non spam}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,}
\PY{p}{]}
\PY{n}{toy\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{toy\PYZus{}spam}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{sms}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{target}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \subsubsection{Spam/non spam toy
example}\label{spamnon-spam-toy-example}

    \begin{itemize}
\tightlist
\item
  What if the feature is in the form of raw text?
\item
  The feature \texttt{sms} below is neither categorical nor ordinal.
\item
  How can we encode it so that we can pass it to the machine learning
  algorithms we have seen so far?
\end{itemize}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{90}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{toy\PYZus{}df}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{90}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
                                                                          sms  \textbackslash{}
0                                                                URGENT!! As a
valued network customer you have been selected to receive a Â£900 prize reward!
1
Lol you are always so convincing.
2
Nah I don't think he goes to usf, he lives around here though
3
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
4  Had your mobile 11 months or more? U R entitled to Update to the latest
colour mobiles with camera for Free! Call The Mobile Update Co FREE on
08002986030
5
Congrats! I can't wait to see you!!

     target
0      spam
1  non spam
2  non spam
3      spam
4      spam
5  non spam
\end{Verbatim}
\end{tcolorbox}
        
    \subsubsection{What if we apply OHE?}\label{what-if-we-apply-ohe}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{91}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{} DO NOT DO THIS.}
\PY{n}{enc} \PY{o}{=} \PY{n}{OneHotEncoder}\PY{p}{(}\PY{n}{sparse\PYZus{}output}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
\PY{n}{transformed} \PY{o}{=} \PY{n}{enc}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{toy\PYZus{}df}\PY{p}{[}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{sms}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{]}\PY{p}{)}
\PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{transformed}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{n}{enc}\PY{o}{.}\PY{n}{categories\PYZus{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{91}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
  Congrats! I can't wait to see you!!  \textbackslash{}
0                                 0.0
1                                 0.0
2                                 0.0
3                                 0.0
4                                 0.0
5                                 1.0

  Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030  \textbackslash{}
0
0.0
1
0.0
2
0.0
3
0.0
4
1.0
5
0.0

  Lol you are always so convincing.  \textbackslash{}
0                               0.0
1                               1.0
2                               0.0
3                               0.0
4                               0.0
5                               0.0

  Nah I don't think he goes to usf, he lives around here though  \textbackslash{}
0                                                           0.0
1                                                           0.0
2                                                           1.0
3                                                           0.0
4                                                           0.0
5                                                           0.0

  URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!  \textbackslash{}
0                                                                         0.0
1                                                                         0.0
2                                                                         0.0
3                                                                         1.0
4                                                                         0.0
5                                                                         0.0

  URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!
0
1.0
1
0.0
2
0.0
3
0.0
4
0.0
5
0.0
\end{Verbatim}
\end{tcolorbox}
        
    \begin{itemize}
\tightlist
\item
  We do not have a fixed number of categories here.
\item
  Each ``category'' (feature value) is likely to occur only once in the
  training data and we won't learn anything meaningful if we apply
  one-hot encoding or ordinal encoding on this feature.
\end{itemize}

    \begin{itemize}
\tightlist
\item
  How can we encode or represent raw text data into fixed number of
  features so that we can learn some useful patterns from it?\\
\item
  This is a well studied problem in the field of Natural Language
  Processing (NLP), which is concerned with giving computers the ability
  to understand written and spoken language.
\item
  Some popular representations of raw text include:

  \begin{itemize}
  \tightlist
  \item
    \textbf{Bag of words}
  \item
    TF-IDF
  \item
    Embedding representations
  \end{itemize}
\end{itemize}

    \subsubsection{Bag of words (BOW)
representation}\label{bag-of-words-bow-representation}

\begin{itemize}
\tightlist
\item
  One of the most popular representation of raw text
\item
  Ignores the syntax and word order
\item
  It has two components:

  \begin{itemize}
  \tightlist
  \item
    The vocabulary (all unique words in all documents)
  \item
    A value indicating either the presence or absence or the count of
    each word in the document.
  \end{itemize}
\end{itemize}

\includegraphics{/Users/charleenchu/Desktop/school/cpsc330-2023W2/lectures/img/bag-of-words.png}

\href{https://web.stanford.edu/~jurafsky/slp3/4.pdf}{Source}

    \subsubsection{\texorpdfstring{Extracting BOW features using
\texttt{scikit-learn}}{Extracting BOW features using scikit-learn}}\label{extracting-bow-features-using-scikit-learn}

\begin{itemize}
\tightlist
\item
  \texttt{CountVectorizer}

  \begin{itemize}
  \tightlist
  \item
    Converts a collection of text documents to a matrix of word
    counts.\\
  \item
    Each row represents a ``document'' (e.g., a text message in our
    example).
  \item
    Each column represents a word in the vocabulary (the set of unique
    words) in the training data.
  \item
    Each cell represents how often the word occurs in the document.
  \end{itemize}
\end{itemize}

    \begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

In the Natural Language Processing (NLP) community text data is referred
to as a \textbf{corpus} (plural: corpora). \_\_\_

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{92}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{feature\PYZus{}extraction}\PY{n+nn}{.}\PY{n+nn}{text} \PY{k+kn}{import} \PY{n}{CountVectorizer}

\PY{n}{vec} \PY{o}{=} \PY{n}{CountVectorizer}\PY{p}{(}\PY{p}{)}
\PY{n}{X\PYZus{}counts} \PY{o}{=} \PY{n}{vec}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{toy\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{sms}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
\PY{n}{bow\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}
    \PY{n}{X\PYZus{}counts}\PY{o}{.}\PY{n}{toarray}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{n}{vec}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names\PYZus{}out}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{n}{toy\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{sms}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
\PY{p}{)}
\PY{n}{bow\PYZus{}df}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{92}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
08002986030  \textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!
0
Lol you are always so convincing.
0
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
0
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030
1
Congrats! I can't wait to see you!!
0

100000  \textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!
0
Lol you are always so convincing.
0
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
1
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030
0
Congrats! I can't wait to see you!!
0

                                                                            11
\textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!                                                                 0
Lol you are always so convincing.
0
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
0
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030   1
Congrats! I can't wait to see you!!
0

                                                                            900
\textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!                                                                  1
Lol you are always so convincing.
0
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
0
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030    0
Congrats! I can't wait to see you!!
0

always  \textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!
0
Lol you are always so convincing.
1
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
0
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030
0
Congrats! I can't wait to see you!!
0

                                                                            are
\textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!                                                                  0
Lol you are always so convincing.
1
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
0
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030    0
Congrats! I can't wait to see you!!
0

around  \textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!
0
Lol you are always so convincing.
0
Nah I don't think he goes to usf, he lives around here though
1
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
0
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030
0
Congrats! I can't wait to see you!!
0

                                                                            as
\textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!                                                                 1
Lol you are always so convincing.
0
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
0
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030   0
Congrats! I can't wait to see you!!
0

                                                                            been
\textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!
1
Lol you are always so convincing.
0
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
0
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030
0
Congrats! I can't wait to see you!!
0

                                                                            call
\textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!
0
Lol you are always so convincing.
0
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
0
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030
1
Congrats! I can't wait to see you!!
0

                                                                            {\ldots}
\textbackslash{}
sms
{\ldots}
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!                                                                {\ldots}
Lol you are always so convincing.
{\ldots}
Nah I don't think he goes to usf, he lives around here though
{\ldots}
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
{\ldots}
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030  {\ldots}
Congrats! I can't wait to see you!!
{\ldots}

update  \textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!
0
Lol you are always so convincing.
0
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
0
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030
2
Congrats! I can't wait to see you!!
0

urgent  \textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!
1
Lol you are always so convincing.
0
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
1
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030
0
Congrats! I can't wait to see you!!
0

                                                                            usf
\textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!                                                                  0
Lol you are always so convincing.
0
Nah I don't think he goes to usf, he lives around here though
1
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
0
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030    0
Congrats! I can't wait to see you!!
0

valued  \textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!
1
Lol you are always so convincing.
0
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
0
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030
0
Congrats! I can't wait to see you!!
0

                                                                            wait
\textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!
0
Lol you are always so convincing.
0
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
0
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030
0
Congrats! I can't wait to see you!!
1

                                                                            week
\textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!
0
Lol you are always so convincing.
0
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
1
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030
0
Congrats! I can't wait to see you!!
0

                                                                            with
\textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!
0
Lol you are always so convincing.
0
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
0
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030
1
Congrats! I can't wait to see you!!
0

                                                                            won
\textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!                                                                  0
Lol you are always so convincing.
0
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
1
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030    0
Congrats! I can't wait to see you!!
0

                                                                            you
\textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!                                                                  1
Lol you are always so convincing.
1
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
1
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030    0
Congrats! I can't wait to see you!!
1

                                                                            your
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!
0
Lol you are always so convincing.
0
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
0
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030
1
Congrats! I can't wait to see you!!
0

[6 rows x 61 columns]
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{93}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n+nb}{type}\PY{p}{(}\PY{n}{toy\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{sms}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{93}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
pandas.core.series.Series
\end{Verbatim}
\end{tcolorbox}
        
    \begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

Note that unlike other transformers we are passing a \texttt{Series}
object to \texttt{fit\_transform}. For other transformers, you can
define one transformer for more multiple columns. But with
\texttt{CountVectorizer} you need to define a separate
\texttt{CountVectorizer} transformer for each text column, if you have
more than one text column.\\
\_\_\_

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{94}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{X\PYZus{}counts}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{94}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
<6x61 sparse matrix of type '<class 'numpy.int64'>'
        with 71 stored elements in Compressed Sparse Row format>
\end{Verbatim}
\end{tcolorbox}
        
    \subsubsection{Why sparse matrices?}\label{why-sparse-matrices}

\begin{itemize}
\tightlist
\item
  Most words do not appear in a given document.
\item
  We get massive computational savings if we only store the nonzero
  elements.
\item
  There is a bit of overhead, because we also need to store the
  locations:

  \begin{itemize}
  \tightlist
  \item
    e.g.~``location (3,27): 1''.
  \end{itemize}
\item
  However, if the fraction of nonzero is small, this is a huge win.
\end{itemize}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{95}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{The total number of elements: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{prod}\PY{p}{(}\PY{n}{X\PYZus{}counts}\PY{o}{.}\PY{n}{shape}\PY{p}{)}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{The number of non\PYZhy{}zero elements: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{X\PYZus{}counts}\PY{o}{.}\PY{n}{nnz}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}
    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Proportion of non\PYZhy{}zero elements: }\PY{l+s+si}{\PYZpc{}0.4f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{X\PYZus{}counts}\PY{o}{.}\PY{n}{nnz} \PY{o}{/} \PY{n}{np}\PY{o}{.}\PY{n}{prod}\PY{p}{(}\PY{n}{X\PYZus{}counts}\PY{o}{.}\PY{n}{shape}\PY{p}{)}\PY{p}{)}
\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}
    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{The value at cell 3,}\PY{l+s+si}{\PYZpc{}d}\PY{l+s+s2}{ is: }\PY{l+s+si}{\PYZpc{}d}\PY{l+s+s2}{\PYZdq{}}
    \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{vec}\PY{o}{.}\PY{n}{vocabulary\PYZus{}}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{jackpot}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{X\PYZus{}counts}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{vec}\PY{o}{.}\PY{n}{vocabulary\PYZus{}}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{jackpot}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{]}\PY{p}{)}
\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
The total number of elements:  366
The number of non-zero elements:  71
Proportion of non-zero elements: 0.1940
The value at cell 3,27 is: 1
    \end{Verbatim}

    Question for you - What would happen if you apply
\texttt{StandardScaler} on sparse data?

    \subsubsection{\texorpdfstring{\texttt{OneHotEncoder} and sparse
features}{OneHotEncoder and sparse features}}\label{onehotencoder-and-sparse-features}

\begin{itemize}
\tightlist
\item
  By default, \texttt{OneHotEncoder} also creates sparse features.
\item
  You could set \texttt{sparse=False} to get a regular \texttt{numpy}
  array.
\item
  If there are a huge number of categories, it may be beneficial to keep
  them sparse.
\item
  For smaller number of categories, it doesn't matter much.
\end{itemize}

    \subsubsection{\texorpdfstring{Important hyperparameters of
\texttt{CountVectorizer}}{Important hyperparameters of CountVectorizer}}\label{important-hyperparameters-of-countvectorizer}

\begin{itemize}
\tightlist
\item
  \texttt{binary}

  \begin{itemize}
  \tightlist
  \item
    whether to use absence/presence feature values or counts
  \end{itemize}
\item
  \texttt{max\_features}

  \begin{itemize}
  \tightlist
  \item
    only consider top \texttt{max\_features} ordered by frequency in the
    corpus
  \end{itemize}
\item
  \texttt{max\_df}

  \begin{itemize}
  \tightlist
  \item
    ignore features which occur in more than \texttt{max\_df} documents
  \end{itemize}
\item
  \texttt{min\_df}

  \begin{itemize}
  \tightlist
  \item
    ignore features which occur in less than \texttt{min\_df} documents
  \end{itemize}
\item
  \texttt{ngram\_range}

  \begin{itemize}
  \tightlist
  \item
    consider word sequences in the given range
  \end{itemize}
\end{itemize}

    Let's look at all features, i.e., words (along with their frequencies).

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{96}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{vec} \PY{o}{=} \PY{n}{CountVectorizer}\PY{p}{(}\PY{p}{)}
\PY{n}{X\PYZus{}counts} \PY{o}{=} \PY{n}{vec}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{toy\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{sms}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
\PY{n}{bow\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}
    \PY{n}{X\PYZus{}counts}\PY{o}{.}\PY{n}{toarray}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{n}{vec}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names\PYZus{}out}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{n}{toy\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{sms}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
\PY{p}{)}
\PY{n}{bow\PYZus{}df}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{96}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
08002986030  \textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!
0
Lol you are always so convincing.
0
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
0
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030
1
Congrats! I can't wait to see you!!
0

100000  \textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!
0
Lol you are always so convincing.
0
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
1
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030
0
Congrats! I can't wait to see you!!
0

                                                                            11
\textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!                                                                 0
Lol you are always so convincing.
0
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
0
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030   1
Congrats! I can't wait to see you!!
0

                                                                            900
\textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!                                                                  1
Lol you are always so convincing.
0
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
0
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030    0
Congrats! I can't wait to see you!!
0

always  \textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!
0
Lol you are always so convincing.
1
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
0
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030
0
Congrats! I can't wait to see you!!
0

                                                                            are
\textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!                                                                  0
Lol you are always so convincing.
1
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
0
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030    0
Congrats! I can't wait to see you!!
0

around  \textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!
0
Lol you are always so convincing.
0
Nah I don't think he goes to usf, he lives around here though
1
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
0
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030
0
Congrats! I can't wait to see you!!
0

                                                                            as
\textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!                                                                 1
Lol you are always so convincing.
0
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
0
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030   0
Congrats! I can't wait to see you!!
0

                                                                            been
\textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!
1
Lol you are always so convincing.
0
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
0
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030
0
Congrats! I can't wait to see you!!
0

                                                                            call
\textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!
0
Lol you are always so convincing.
0
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
0
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030
1
Congrats! I can't wait to see you!!
0

                                                                            {\ldots}
\textbackslash{}
sms
{\ldots}
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!                                                                {\ldots}
Lol you are always so convincing.
{\ldots}
Nah I don't think he goes to usf, he lives around here though
{\ldots}
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
{\ldots}
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030  {\ldots}
Congrats! I can't wait to see you!!
{\ldots}

update  \textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!
0
Lol you are always so convincing.
0
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
0
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030
2
Congrats! I can't wait to see you!!
0

urgent  \textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!
1
Lol you are always so convincing.
0
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
1
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030
0
Congrats! I can't wait to see you!!
0

                                                                            usf
\textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!                                                                  0
Lol you are always so convincing.
0
Nah I don't think he goes to usf, he lives around here though
1
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
0
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030    0
Congrats! I can't wait to see you!!
0

valued  \textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!
1
Lol you are always so convincing.
0
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
0
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030
0
Congrats! I can't wait to see you!!
0

                                                                            wait
\textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!
0
Lol you are always so convincing.
0
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
0
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030
0
Congrats! I can't wait to see you!!
1

                                                                            week
\textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!
0
Lol you are always so convincing.
0
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
1
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030
0
Congrats! I can't wait to see you!!
0

                                                                            with
\textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!
0
Lol you are always so convincing.
0
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
0
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030
1
Congrats! I can't wait to see you!!
0

                                                                            won
\textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!                                                                  0
Lol you are always so convincing.
0
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
1
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030    0
Congrats! I can't wait to see you!!
0

                                                                            you
\textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!                                                                  1
Lol you are always so convincing.
1
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
1
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030    0
Congrats! I can't wait to see you!!
1

                                                                            your
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!
0
Lol you are always so convincing.
0
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
0
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030
1
Congrats! I can't wait to see you!!
0

[6 rows x 61 columns]
\end{Verbatim}
\end{tcolorbox}
        
    When we use \texttt{binary=True}, the representation uses
presence/absence of words instead of word counts.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{97}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{vec\PYZus{}binary} \PY{o}{=} \PY{n}{CountVectorizer}\PY{p}{(}\PY{n}{binary}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\PY{n}{X\PYZus{}counts} \PY{o}{=} \PY{n}{vec\PYZus{}binary}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{toy\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{sms}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
\PY{n}{bow\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}
    \PY{n}{X\PYZus{}counts}\PY{o}{.}\PY{n}{toarray}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{n}{vec\PYZus{}binary}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names\PYZus{}out}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{n}{toy\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{sms}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
\PY{p}{)}
\PY{n}{bow\PYZus{}df}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{97}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
08002986030  \textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!
0
Lol you are always so convincing.
0
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
0
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030
1
Congrats! I can't wait to see you!!
0

100000  \textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!
0
Lol you are always so convincing.
0
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
1
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030
0
Congrats! I can't wait to see you!!
0

                                                                            11
\textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!                                                                 0
Lol you are always so convincing.
0
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
0
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030   1
Congrats! I can't wait to see you!!
0

                                                                            900
\textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!                                                                  1
Lol you are always so convincing.
0
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
0
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030    0
Congrats! I can't wait to see you!!
0

always  \textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!
0
Lol you are always so convincing.
1
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
0
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030
0
Congrats! I can't wait to see you!!
0

                                                                            are
\textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!                                                                  0
Lol you are always so convincing.
1
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
0
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030    0
Congrats! I can't wait to see you!!
0

around  \textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!
0
Lol you are always so convincing.
0
Nah I don't think he goes to usf, he lives around here though
1
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
0
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030
0
Congrats! I can't wait to see you!!
0

                                                                            as
\textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!                                                                 1
Lol you are always so convincing.
0
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
0
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030   0
Congrats! I can't wait to see you!!
0

                                                                            been
\textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!
1
Lol you are always so convincing.
0
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
0
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030
0
Congrats! I can't wait to see you!!
0

                                                                            call
\textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!
0
Lol you are always so convincing.
0
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
0
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030
1
Congrats! I can't wait to see you!!
0

                                                                            {\ldots}
\textbackslash{}
sms
{\ldots}
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!                                                                {\ldots}
Lol you are always so convincing.
{\ldots}
Nah I don't think he goes to usf, he lives around here though
{\ldots}
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
{\ldots}
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030  {\ldots}
Congrats! I can't wait to see you!!
{\ldots}

update  \textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!
0
Lol you are always so convincing.
0
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
0
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030
1
Congrats! I can't wait to see you!!
0

urgent  \textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!
1
Lol you are always so convincing.
0
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
1
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030
0
Congrats! I can't wait to see you!!
0

                                                                            usf
\textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!                                                                  0
Lol you are always so convincing.
0
Nah I don't think he goes to usf, he lives around here though
1
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
0
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030    0
Congrats! I can't wait to see you!!
0

valued  \textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!
1
Lol you are always so convincing.
0
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
0
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030
0
Congrats! I can't wait to see you!!
0

                                                                            wait
\textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!
0
Lol you are always so convincing.
0
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
0
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030
0
Congrats! I can't wait to see you!!
1

                                                                            week
\textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!
0
Lol you are always so convincing.
0
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
1
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030
0
Congrats! I can't wait to see you!!
0

                                                                            with
\textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!
0
Lol you are always so convincing.
0
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
0
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030
1
Congrats! I can't wait to see you!!
0

                                                                            won
\textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!                                                                  0
Lol you are always so convincing.
0
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
1
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030    0
Congrats! I can't wait to see you!!
0

                                                                            you
\textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!                                                                  1
Lol you are always so convincing.
1
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
1
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030    0
Congrats! I can't wait to see you!!
1

                                                                            your
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!
0
Lol you are always so convincing.
0
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
0
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030
1
Congrats! I can't wait to see you!!
0

[6 rows x 61 columns]
\end{Verbatim}
\end{tcolorbox}
        
    We can control the size of X (the number of features) using
\texttt{max\_features}.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{98}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{vec8} \PY{o}{=} \PY{n}{CountVectorizer}\PY{p}{(}\PY{n}{max\PYZus{}features}\PY{o}{=}\PY{l+m+mi}{8}\PY{p}{)}
\PY{n}{X\PYZus{}counts} \PY{o}{=} \PY{n}{vec8}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{toy\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{sms}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
\PY{n}{bow\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}
    \PY{n}{X\PYZus{}counts}\PY{o}{.}\PY{n}{toarray}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{n}{vec8}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names\PYZus{}out}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{n}{toy\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{sms}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}
\PY{p}{)}
\PY{n}{bow\PYZus{}df}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{98}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
                                                                            free
\textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!
0
Lol you are always so convincing.
0
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
1
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030
2
Congrats! I can't wait to see you!!
0

                                                                            have
\textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!
1
Lol you are always so convincing.
0
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
1
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030
0
Congrats! I can't wait to see you!!
0

mobile  \textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!
0
Lol you are always so convincing.
0
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
0
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030
2
Congrats! I can't wait to see you!!
0

                                                                            the
\textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!                                                                  0
Lol you are always so convincing.
0
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
0
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030    2
Congrats! I can't wait to see you!!
0

                                                                            to
\textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!                                                                 1
Lol you are always so convincing.
0
Nah I don't think he goes to usf, he lives around here though
1
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
0
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030   2
Congrats! I can't wait to see you!!
1

update  \textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!
0
Lol you are always so convincing.
0
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
0
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030
2
Congrats! I can't wait to see you!!
0

urgent  \textbackslash{}
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!
1
Lol you are always so convincing.
0
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
1
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030
0
Congrats! I can't wait to see you!!
0

                                                                            you
sms
URGENT!! As a valued network customer you have been selected to receive a Â£900
prize reward!                                                                  1
Lol you are always so convincing.
1
Nah I don't think he goes to usf, he lives around here though
0
URGENT! You have won a 1 week FREE membership in our Â£100000 prize Jackpot!
1
Had your mobile 11 months or more? U R entitled to Update to the latest colour
mobiles with camera for Free! Call The Mobile Update Co FREE on 08002986030    0
Congrats! I can't wait to see you!!
1
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{99}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{vec8} \PY{o}{=} \PY{n}{CountVectorizer}\PY{p}{(}\PY{n}{max\PYZus{}features}\PY{o}{=}\PY{l+m+mi}{8}\PY{p}{)}
\PY{n}{X\PYZus{}counts} \PY{o}{=} \PY{n}{vec8}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{toy\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{sms}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
\PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}
    \PY{n}{data}\PY{o}{=}\PY{n}{X\PYZus{}counts}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{tolist}\PY{p}{(}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}
    \PY{n}{index}\PY{o}{=}\PY{n}{vec8}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names\PYZus{}out}\PY{p}{(}\PY{p}{)}\PY{p}{,}
    \PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{counts}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,}
\PY{p}{)}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{counts}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{99}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
        counts
to           5
you          4
free         3
have         2
mobile       2
the          2
update       2
urgent       2
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{100}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{vec8\PYZus{}binary} \PY{o}{=} \PY{n}{CountVectorizer}\PY{p}{(}\PY{n}{binary}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{max\PYZus{}features}\PY{o}{=}\PY{l+m+mi}{8}\PY{p}{)}
\PY{n}{X\PYZus{}counts} \PY{o}{=} \PY{n}{vec8\PYZus{}binary}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{toy\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{sms}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
\PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}
    \PY{n}{data}\PY{o}{=}\PY{n}{X\PYZus{}counts}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{.}\PY{n}{tolist}\PY{p}{(}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}
    \PY{n}{index}\PY{o}{=}\PY{n}{vec8\PYZus{}binary}\PY{o}{.}\PY{n}{get\PYZus{}feature\PYZus{}names\PYZus{}out}\PY{p}{(}\PY{p}{)}\PY{p}{,}
    \PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{counts}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,}
\PY{p}{)}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{counts}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{100}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
         counts
to            4
you           4
free          2
have          2
prize         2
urgent        2
mobiles       1
months        1
\end{Verbatim}
\end{tcolorbox}
        
    \begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

Notice that \texttt{vec8} and \texttt{vec8\_binary} have different
vocabularies, which is kind of unexpected behaviour and doesn't match
the documentation of \texttt{scikit-learn}.

\href{https://github.com/scikit-learn/scikit-learn/blob/master/sklearn/feature_extraction/text.py\#L1206-L1225}{Here}
is the code for \texttt{binary=True} condition in \texttt{scikit-learn}.
As we can see, the binarization is done before limiting the features to
\texttt{max\_features}, and so now we are actually looking at the
document counts (in how many documents it occurs) rather than term
count. This is not explained anywhere in the documentation.

The ties in counts between different words makes it even more confusing.
I don't think it'll have a big impact on the results but this is good to
know! Remember that \texttt{scikit-learn} developers are also humans,
who are prone to make mistakes. So it's always a good habit to question
whatever tools we use every now and then. \_\_\_

    \subsubsection{Preprocessing}\label{preprocessing}

\begin{itemize}
\tightlist
\item
  Note that \texttt{CountVectorizer} is carrying out some preprocessing
  such as because of the default argument values

  \begin{itemize}
  \tightlist
  \item
    Converting words to lowercase (\texttt{lowercase=True})
  \item
    getting rid of punctuation and special characters
    (\texttt{token\_pattern\ =\textquotesingle{}(?u)\textbackslash{}\textbackslash{}b\textbackslash{}\textbackslash{}w\textbackslash{}\textbackslash{}w+\textbackslash{}\textbackslash{}b\textquotesingle{}})
  \end{itemize}
\end{itemize}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{101}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{pipe} \PY{o}{=} \PY{n}{make\PYZus{}pipeline}\PY{p}{(}\PY{n}{CountVectorizer}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{SVC}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{102}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{pipe}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{toy\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{sms}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{toy\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{target}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{102}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
Pipeline(steps=[('countvectorizer', CountVectorizer()), ('svc', SVC())])
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{103}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{pipe}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{toy\PYZus{}df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{sms}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{103}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
array(['spam', 'non spam', 'non spam', 'spam', 'spam', 'non spam'],
      dtype=object)
\end{Verbatim}
\end{tcolorbox}
        
    \subsubsection{Is this a realistic representation of text
data?}\label{is-this-a-realistic-representation-of-text-data}

\begin{itemize}
\tightlist
\item
  Of course this is not a great representation of language

  \begin{itemize}
  \tightlist
  \item
    We are throwing out everything we know about language and losing a
    lot of information.
  \item
    It assumes that there is no syntax and compositional meaning in
    language.\\
  \end{itemize}
\item
  But it works surprisingly well for many tasks.
\item
  We will learn more expressive representations in the coming weeks.
\end{itemize}

    

    

    \subsection{ââ Questions for you}\label{questions-for-you}

    \subsubsection{(iClicker) Exercise 6.2}\label{iclicker-exercise-6.2}

\textbf{iClicker cloud join link: https://join.iclicker.com/WMSX}

\textbf{Select all of the following statements which are TRUE.}

\begin{itemize}
\tightlist
\item
  \begin{enumerate}
  \def\labelenumi{(\Alph{enumi})}
  \tightlist
  \item
    \texttt{handle\_unknown="ignore"} would treat all unknown categories
    equally.
  \end{enumerate}
\item
  \begin{enumerate}
  \def\labelenumi{(\Alph{enumi})}
  \setcounter{enumi}{1}
  \tightlist
  \item
    As you increase the value for \texttt{max\_features} hyperparameter
    of \texttt{CountVectorizer} the training score is likely to get
    better.
  \end{enumerate}
\item
  \begin{enumerate}
  \def\labelenumi{(\Alph{enumi})}
  \setcounter{enumi}{2}
  \tightlist
  \item
    Suppose you are encoding text data using \texttt{CountVectorizer}.
    If you encounter a word in the validation or the test split that's
    not available in the training data, we'll get an error.
  \end{enumerate}
\item
  \begin{enumerate}
  \def\labelenumi{(\Alph{enumi})}
  \setcounter{enumi}{3}
  \tightlist
  \item
    In the code below, inside \texttt{cross\_validate}, each fold might
    have slightly different number of features (columns) in the fold.
  \end{enumerate}
\end{itemize}

\begin{verbatim}
pipe = (CountVectorizer(), SVC())
cross_validate(pipe, X_train, y_train)
\end{verbatim}

    

    \subsection{What did we learn today?}\label{what-did-we-learn-today}

\begin{itemize}
\tightlist
\item
  Motivation to use \texttt{ColumnTransformer}
\item
  \texttt{ColumnTransformer} syntax
\item
  Defining transformers with multiple transformations
\item
  How to visualize transformed features in a dataframe
\item
  More on ordinal features
\item
  Different arguments \texttt{OneHotEncoder}

  \begin{itemize}
  \tightlist
  \item
    \texttt{handle\_unknow="ignore"}
  \item
    \texttt{if\_binary}
  \end{itemize}
\item
  Dealing with text features

  \begin{itemize}
  \tightlist
  \item
    Bag of words representation: \texttt{CountVectorizer}
  \end{itemize}
\end{itemize}

    \includegraphics{/Users/charleenchu/Desktop/school/cpsc330-2023W2/lectures/img/eva-talksoon.png}


    % Add a bibliography block to the postdoc
    
    
    
\end{document}
